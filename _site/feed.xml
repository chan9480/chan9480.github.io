<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-04-10T21:59:19+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">ë°°ìš°ì ê·¸ë¦¬ê³  ì¨ë¨¹ì</title><subtitle>í¬íŠ¸í´ë¦¬ì˜¤</subtitle><author><name>ì˜¹ë‹¬ìƒ˜ğŸ‘±ğŸ¼â€â™‚ï¸</name></author><entry><title type="html">1x1 conv, ê·¸ë¦¬ê³  conv2d conv3dì˜ ì´í•´</title><link href="http://localhost:4000/ds/1by1conv/" rel="alternate" type="text/html" title="1x1 conv, ê·¸ë¦¬ê³  conv2d conv3dì˜ ì´í•´" /><published>2022-04-09T00:00:00+09:00</published><updated>2022-04-09T00:00:00+09:00</updated><id>http://localhost:4000/ds/1by1conv</id><content type="html" xml:base="http://localhost:4000/ds/1by1conv/"><![CDATA[<h2 id="1by1-convëŠ”-ì–´ë–»ê²Œ-ìƒê¸´ê±°ëƒ">1by1 convëŠ” ì–´ë–»ê²Œ ìƒê¸´ê±°ëƒ</h2>
<p>ì²˜ìŒì—” 1by1 ì‚¬ì´ì¦ˆì˜ í•„í„°ê°€ CNNì—ì„œ ì˜ë¯¸ê°€ ìˆë‚˜ ìƒê°í–ˆë‹¤.<br />
ê·¼ë° ê·¸ê²Œ ì•„ë‹ˆë¼ 1by1byN ëª¨ì–‘ì˜ í•„í„°ì˜€ë˜ ê²ƒ!<br />
í”¼ì³ë§µì˜ ê¸¸ì´ë¥¼ ì¤„ì¼ ìˆ˜ ìˆê³ , ì´ë¥¼ í¬í•¨í•˜ëŠ” CNNêµ¬ì¡°ë“¤ì€ ë¹„êµì  ë” ì´í›„ì— ë‚˜ì˜¨ êµ¬ì¡°ì´ê¸°ë„ í•˜ê³ ,<br />
ì—°ì‚°ëŸ‰ì„ ì¤„ì´ê³  ì†ë„ë¥¼ ë†’ì´ëŠ” ì—­í• ì„ í• ê¹Œ?</p>

<h2 id="2ì°¨ì›-í•„í„°ëŠ”-conv2d-3ì°¨ì›-í•„í„°ëŠ”-conv3d">2ì°¨ì› í•„í„°ëŠ” conv2d, 3ì°¨ì› í•„í„°ëŠ” conv3d</h2>
<p>ë‚´ê°€ ì´í•´í•œê²Œ ë§ë‹¤ë©´ conv2dëŠ” í”¼ì³ë§µê¸¸ì´ëŠ” ê°™ê±°ë‚˜, ì¦ê°€í•  ìˆ˜ ë°–ì— ì—†ê³ <br />
conv3dëŠ” ê°ì†Œ, ë™ì¼, ì¦ê°€ ëª¨ë‘ ê°€ëŠ¥í•˜ë‹¤.</p>

<h2 id="1by1-convì˜-ì˜ˆì‹œ">1by1 convì˜ ì˜ˆì‹œ</h2>
<p>3by3 í•„í„°ë¥¼ ì‚¬ìš©í•˜ëŠ”<br />
inputì´ (7,7,32), output ì‚¬ì´ì¦ˆê°€ (7,7,64)ë¼ê³  í•´ë³´ì(same padding)<br />
conv2dë¥¼ ì‚¬ìš©í•˜ë©´ íŒŒë¼ë¯¸í„°ëŠ”  (3x3)x32x64+64 = 18496.<br />
conv3dë¥¼ ì‚¬ìš©í•´ë„ ì‹ì˜ ì˜ë¯¸ëŠ” ë‹¤ë¥´ì§€ë§Œ (3x3x32)x64+64 = 18496.</p>

<p>1x1 convë¥¼ ì‚¬ìš©í•˜ì—¬ (7,7,16) ìœ¼ë¡œ ë³€í™˜ í›„ (7,7,64) ë¡œ ë°”ê¾¼ë‹¤ë©´<br />
(1x1x32x16+16) + (3x3x16x64+64) = 528 + 9280 = 9808.</p>

<p>íŒŒë¼ë¯¸í„°ì˜ ìˆ˜ë¥¼ ìƒë‹¹íˆ ì¤„ì¼ ìˆ˜ ìˆë‹¤</p>

<p>VGGnetì—ì„œ Resnetì€ VGGnet ëŒ€ë¹„ ê¸°ìš¸ê¸° ì†Œì‹¤ì„ ë§‰ìŒìœ¼ë¡œì¨ ëª¨ë¸ì„ ë” ê¹Šê²Œ ìŒ“ì„ ìˆ˜ ìˆì—ˆë‹¤ë©´,<br />
1by1 convì˜ ê²½ìš°ì—ëŠ” íŒŒë¼ë¯¸í„°ì˜ ìˆ˜ë¥¼ ì¤„ì„ìœ¼ë¡œì¨ ëª¨ë¸ì„ ë” ê¹Šê²Œ ìŒ“ì„ ìˆ˜ ìˆì„ ê²ƒ.</p>

<h2 id="fire-module">fire module</h2>

<p>1x1 convë¥¼ ì‚¬ìš©í•˜ëŠ” ëŒ€í‘œì ì¸ ì˜ˆì‹œê°€ fire moduleì¸ë°,  3x3 convã„¹</p>

<p>ë¯¸ì™„ ì°¸ê³ ì¤‘ :<br />
https://hoya012.github.io/blog/deeplearning-classification-guidebook-3/</p>

<p><br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš°
ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„
</code></pre></div></div>

<p><a href="#" class="btn btn--primary align-right">ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°</a></p>]]></content><author><name>ì˜¹ë‹¬ìƒ˜ğŸ‘±ğŸ¼â€â™‚ï¸</name></author><category term="ds" /><summary type="html"><![CDATA[1by1 convëŠ” ì–´ë–»ê²Œ ìƒê¸´ê±°ëƒ ì²˜ìŒì—” 1by1 ì‚¬ì´ì¦ˆì˜ í•„í„°ê°€ CNNì—ì„œ ì˜ë¯¸ê°€ ìˆë‚˜ ìƒê°í–ˆë‹¤. ê·¼ë° ê·¸ê²Œ ì•„ë‹ˆë¼ 1by1byN ëª¨ì–‘ì˜ í•„í„°ì˜€ë˜ ê²ƒ! í”¼ì³ë§µì˜ ê¸¸ì´ë¥¼ ì¤„ì¼ ìˆ˜ ìˆê³ , ì´ë¥¼ í¬í•¨í•˜ëŠ” CNNêµ¬ì¡°ë“¤ì€ ë¹„êµì  ë” ì´í›„ì— ë‚˜ì˜¨ êµ¬ì¡°ì´ê¸°ë„ í•˜ê³ , ì—°ì‚°ëŸ‰ì„ ì¤„ì´ê³  ì†ë„ë¥¼ ë†’ì´ëŠ” ì—­í• ì„ í• ê¹Œ?]]></summary></entry><entry><title type="html">YOLOë¥¼ ì´í•´í•˜ê¸° ìœ„í•œ CNN ê°ì²´ì¸ì‹ ëª¨ë¸</title><link href="http://localhost:4000/ds/YOLO/" rel="alternate" type="text/html" title="YOLOë¥¼ ì´í•´í•˜ê¸° ìœ„í•œ CNN ê°ì²´ì¸ì‹ ëª¨ë¸" /><published>2022-04-07T00:00:00+09:00</published><updated>2022-04-07T00:00:00+09:00</updated><id>http://localhost:4000/ds/YOLO</id><content type="html" xml:base="http://localhost:4000/ds/YOLO/"><![CDATA[<h2 id="ìœ ëª…-ì´ë¯¸ì§€-ë°ì´í„°">ìœ ëª… ì´ë¯¸ì§€ ë°ì´í„°</h2>
<p>cifar10, 100 : í´ë˜ìŠ¤ 10, 100ê°œì˜ ê°–ëŠ” ì‚¬ë¬¼ ì´ë¯¸ì§€(32,32) ë°ì´í„° ì…‹ (í•™ìŠµìš© 50000ê°œ)<br />
imagenet :  í´ë˜ìŠ¤ í›¨ì”¬ ë‹¤ì–‘(ëª‡ì²œ, ëª‡ë§Œ), ë°±ë§Œê°œê°€ ë„˜ìŒ.</p>

<h2 id="ê°ì²´-ì¸ì‹-ëª¨ë¸ì˜-ì „ë°˜ì ì¸-ìƒê¹€ìƒˆ">ê°ì²´ ì¸ì‹ ëª¨ë¸ì˜ ì „ë°˜ì ì¸ ìƒê¹€ìƒˆ</h2>
<p><img src="/assets/images/source_34.png" height="100%" />
&lt; 2stageì™€ 1stage êµ¬ì¡° ê·¸ë¦¼&gt;</p>

<ol>
  <li>
    <p>2-stage detector : region proposal networkë¥¼ í¬í•¨í•œë‹¤. ì´ëŠ” ìì£¼ íƒì§€ë˜ëŠ” ë¶€ë¶„ì„ í•™ìŠµí•œë‹¤ëŠ” ì˜ë¯¸. + localizationê³¼ classificationì„ â€˜ê°ê°â€™ ì§„í–‰í•œë‹¤ëŠ” ì˜ë¯¸.</p>
  </li>
  <li>
    <p>single(1-stage) detector : localizationê³¼ classificationì„ ë™ì‹œì— ì§„í–‰.</p>
  </li>
</ol>

<h2 id="ê°ì²´-ë¶„ë¥˜-backbone">ê°ì²´ ë¶„ë¥˜ (Backbone)</h2>
<ul>
  <li>
    <p>VGGnet : 3x3 convë§Œ ì‚¬ìš©í•˜ì—¬ êµ¬ì¡°ê°€ ë‹¨ìˆœí•œë° ë¹„í•´ ê¸°ëŠ¥ì€ ì¤€ìˆ˜í•¨.</p>
  </li>
  <li>
    <p>Resnet : 3x3 convë¥¼ í¬í•¨í•˜ë©° convë¥¼ ë¬´ì‹œ í›„ ì§€ë‚˜ê°€ëŠ” shortcutì„ ê°–ëŠ” residual block ìœ¼ë¡œ êµ¬ì„±ë¨. (Resnet152ì—ì„œëŠ” 1x1 convë¥¼ í¬í•¨í•˜ëŠ” residual blockì„ ì‚¬ìš©í•¨) ê¸°ìš¸ê¸° ì†ì‹¤ ë°©ì§€ë¥¼ í†µí•´ ê¹Šì´ë¥¼ ê¹Šê²Œ ìŒ“ì„ ìˆ˜ ìˆê²Œ ë¨.</p>
  </li>
</ul>

<p><img src="/assets/images/source_35.png" width="50%" /></p>

<ul>
  <li>Dense net : Resnetê°™ì´ reluê°€ ì•„ë‹Œ, concatìœ¼ë¡œ ì´ì „ ì •ë³´ë¥¼ ê°€ì ¸ê°„ë‹¤ëŠ” ì°¨ì´ê°€ ìˆìŒ.</li>
</ul>

<p><img src="/assets/images/source_36.png" height="100%" /></p>

<ul>
  <li>CSP-Darknet : Densenetì„ ê¸°ì´ˆë¡œ CSPë¥¼ ì ìš©ì‹œí‚´</li>
  <li>CSP ë°©ë²• : ë¶„ë¦¬ëœ feature mapì„ ë‹¤ì‹œ ë³‘í•©í•´ì£¼ë‹¤?</li>
</ul>

<h2 id="neck">Neck</h2>
<p><img src="/assets/images/source_38.png" width="50%" />
<img src="/assets/images/source_39.png" height="70%" /></p>
<ol>
  <li>
    <p>additional blocks : ë‹¤ì–‘í•œ í¬ê¸°ì˜ í”¼ì³ë§µë“¤ì„ ë§Œë“¤ì–´ ì •ë³´ë¥¼ ìˆ˜ì§‘ SPP : ì•„í•˜<br />
(ì‚¬ì§„ ì˜ˆì‹œ(ì¢Œ) : SPP, ëª¨ë“  í”¼ì³ë§µë“¤ì„ ëª‡ê°€ì§€ ê²½ìš°ì˜ gridë¡œ ë‚˜ëˆ„ì–´ flattení•œ í›„ í‰ê· ì„ ëƒ„ )</p>
  </li>
  <li>
    <p>path-aggregation blocks : bottom-up path ì™€ top-down pathì—ì„œ ì •ë³´ë¥¼ ìˆ˜ì§‘<br />
(ì‚¬ì§„ ì˜ˆì‹œ(ìš°) : PAN, ê¸°ì¡´ FPN ë„¤íŠ¸ì›Œí¬ì—ì„œ ë¹¨ê°„ì„ , ì´ˆë¡ì„ ê³¼ ê°™ì´ low-level-featureë¥¼ high-level-featureì— ì „ë‹¬í•˜ì—¬ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚´.)</p>
  </li>
</ol>

<h2 id="head">Head</h2>
<ol>
  <li>ì˜ì—­ ì œí•œ faster R-CNN<br />
ìì£¼ ìƒì„±ë˜ëŠ” ìœ„ì¹˜ë¥¼ í•™ìŠµí•œë‹¤. region proposal net</li>
  <li>ì‚¬ì´ì¦ˆ ì œí•œ YOLO  <br />
ì •í•´ì§„ ê·¸ë¦¬ë“œë¡œ ë‚˜ëˆ„ì–´ CNNìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤.</li>
</ol>

<p>ë¯¸ì™„, ì°¸ê³ ì¤‘ :<br />
https://herbwood.tistory.com/24<br />
https://deep-learning-study.tistory.com/528<br />
https://ganghee-lee.tistory.com/34</p>

<p><br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš°
ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„
</code></pre></div></div>

<p><a href="#" class="btn btn--primary align-right">ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°</a></p>]]></content><author><name>ì˜¹ë‹¬ìƒ˜ğŸ‘±ğŸ¼â€â™‚ï¸</name></author><category term="ds" /><summary type="html"><![CDATA[ìœ ëª… ì´ë¯¸ì§€ ë°ì´í„° cifar10, 100 : í´ë˜ìŠ¤ 10, 100ê°œì˜ ê°–ëŠ” ì‚¬ë¬¼ ì´ë¯¸ì§€(32,32) ë°ì´í„° ì…‹ (í•™ìŠµìš© 50000ê°œ) imagenet : í´ë˜ìŠ¤ í›¨ì”¬ ë‹¤ì–‘(ëª‡ì²œ, ëª‡ë§Œ), ë°±ë§Œê°œê°€ ë„˜ìŒ.]]></summary></entry><entry><title type="html">í´ë¼ìš°ë“œ ë°ì´í„°ë² ì´ìŠ¤, SQL</title><link href="http://localhost:4000/de/CloudDB/" rel="alternate" type="text/html" title="í´ë¼ìš°ë“œ ë°ì´í„°ë² ì´ìŠ¤, SQL" /><published>2022-04-02T00:00:00+09:00</published><updated>2022-04-02T00:00:00+09:00</updated><id>http://localhost:4000/de/CloudDB</id><content type="html" xml:base="http://localhost:4000/de/CloudDB/"><![CDATA[<h1 id="í´ë¼ìš°ë“œ-ë°ì´í„°ë² ì´ìŠ¤">í´ë¼ìš°ë“œ ë°ì´í„°ë² ì´ìŠ¤</h1>
<p>ë§ ê·¸ëŒ€ë¡œ ì˜¨ë¼ì¸ìœ¼ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë§í•œë‹¤.</p>
<ol>
  <li>ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤  (oracle DB, mySQL, PostgreSQL ë“±)</li>
  <li>NoSQL  (MongoDB, Redis, Hbase Neo4jë“±)</li>
</ol>

<h2 id="ê´€ê³„í˜•-ë°ì´í„°ë² ì´ìŠ¤-rdb--relational-database">ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ (RDB : Relational DataBase)</h2>
<p>ìŠ¤í‚¤ë§ˆì˜ í˜•íƒœë¡œ ë°ì´í„°ë“¤ì˜ ì—°ê´€ì„±ì„ ê³ ë ¤í•´ì„œ ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤.<br />
ë°ì´í„°ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•´ SQLì–¸ì–´ë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤.</p>

<blockquote>
  <p>ìŠ¤í‚¤ë§ˆ ì´ë¯¸ì§€<br />
<img src="/assets/images/source_33.png" width="70%" /></p>
</blockquote>

<h2 id="nosql">NoSQL</h2>
<p>ë§ê·¸ëŒ€ë¡œ SQLì— í•œì •ë˜ì§€ ì•Šê² ë‹¤ëŠ” ì˜ì§€ë¥¼ ë‹´ì€ ë°ì´í„°ë² ì´ìŠ¤</p>

<p>í˜•ì‹ì˜ ììœ ë¡œìš´ ë°ì´í„°ë“¤ì„ ë”•ì…”ë„ˆë¦¬ì™€ ê°™ì´ Keyì™€ ê°’ì˜ ê´€ê³„ë¡œ ì €ì¥í•´ì„œ,<br />
Keyë¡œ í•˜ì—¬ê¸ˆ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ” êµ¬ì¡°ë¥¼ ë§í•œë‹¤.</p>

<p>ê·¸ í˜•íƒœì— ë”°ë¼ Key-value(keyí•˜ë‚˜ì˜ valueì— ì—¬ëŸ¬ columnê°’ë“¤ì„ ê°€ì§), document(í•˜ë‚˜ì˜ docì€ ì—¬ëŸ¬ key:value ì„¸íŠ¸ë¥¼ ê°–ëŠ” dictí˜•), wide-column(key-valueì™€ ë¹„ìŠ·í•œë° ì¢€ ë” í˜•ì‹ì´ ë”í•´ì ¸, ëœ ìœ ì—°í•œ êµ¬ì¡°), graph ë“±ì˜ ì¢…ë¥˜ê°€ ìˆë‹¤.</p>

<h2 id="ë°ì´íƒ€-ë² ì´ìŠ¤-êµ¬ì¡°ì˜-ìœ ì—°í•¨ì˜-ì˜ë¯¸">ë°ì´íƒ€ ë² ì´ìŠ¤ êµ¬ì¡°ì˜ ìœ ì—°í•¨ì˜ ì˜ë¯¸</h2>
<p>ìœ ì—° up &lt;-&gt; í™•ì¥ì„± up , ë¬´ê²°ì„±, ì•ˆì •ì„±, ê´€ë¦¬ìš©ì´ì„± down</p>

<p>í™•ì¥ì„±ì— ëŒ€í•´ì„œëŠ” ìˆ˜í‰ì ìœ¼ë¡œ ìš©ì´í•œì§€, ìˆ˜ì§ì ìœ¼ë¡œ ìš©ì´í•œì§€ ì• ë§¤í•  ìˆ˜ ìˆë‹¤.</p>

<p>RDBì˜ ê²½ìš° ìƒëŒ€ì ìœ¼ë¡œ ëœ ìœ ì—°í•˜ë”ë¼ë„ ìˆ˜ì§ì  í™•ì¥ìœ¼ë¡œëŠ” ë” ê°•ì ì´ ìˆë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.</p>

<h1 id="sql-ë¬¸ë²•-ì´ëª¨ì €ëª¨">SQL ë¬¸ë²• ì´ëª¨ì €ëª¨</h1>

<p>FROM
WHERE
GROUP BY
HAVING
SELECT
ORDER BY</p>

<h1 id="pythonì—ì„œ-í´ë¼ìš°ë“œ-ë°ì´í„°ë² ì´-ì‚¬ìš©">pythonì—ì„œ í´ë¼ìš°ë“œ ë°ì´í„°ë² ì´ ì‚¬ìš©</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<p><br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš°
ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„
</code></pre></div></div>

<p><a href="#" class="btn btn--primary align-right">ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°</a></p>]]></content><author><name>ì˜¹ë‹¬ìƒ˜ğŸ‘±ğŸ¼â€â™‚ï¸</name></author><category term="de" /><summary type="html"><![CDATA[í´ë¼ìš°ë“œ ë°ì´í„°ë² ì´ìŠ¤ ë§ ê·¸ëŒ€ë¡œ ì˜¨ë¼ì¸ìœ¼ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë§í•œë‹¤. ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ (oracle DB, mySQL, PostgreSQL ë“±) NoSQL (MongoDB, Redis, Hbase Neo4jë“±)]]></summary></entry><entry><title type="html">wikië°ì´í„°ë¥¼ ì´ìš©í•œ ì´ë¯¸ì§€ ìº¡ì…”ë‹</title><link href="http://localhost:4000/pj/image_captioning/" rel="alternate" type="text/html" title="wikië°ì´í„°ë¥¼ ì´ìš©í•œ ì´ë¯¸ì§€ ìº¡ì…”ë‹" /><published>2022-03-28T00:00:00+09:00</published><updated>2022-03-28T00:00:00+09:00</updated><id>http://localhost:4000/pj/image_captioning</id><content type="html" xml:base="http://localhost:4000/pj/image_captioning/"><![CDATA[<h3 id="mac-gpu-ì‚¬ìš©ê°€ëŠ¥í™•ì¸-1ì´ë©´-ì‚¬ìš©ê°€ëŠ¥">mac gpu ì‚¬ìš©ê°€ëŠ¥í™•ì¸ (1ì´ë©´ ì‚¬ìš©ê°€ëŠ¥)</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"Num GPUs Available: "</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">experimental</span><span class="p">.</span><span class="n">list_physical_devices</span><span class="p">(</span><span class="s">'GPU'</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Num GPUs Available:  0
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="p">.</span><span class="n">mount</span><span class="p">(</span><span class="s">'/content/drive'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Mounted at /content/drive
</code></pre></div></div>

<h1 id="import">import</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># tensorflow.compat.v2 ë¥¼ ì‚¬ìš©
</span><span class="kn">import</span> <span class="nn">tensorflow.compat.v2</span> <span class="k">as</span> <span class="n">tf</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">time</span>
</code></pre></div></div>

<h1 id="dataset">dataset</h1>
<blockquote>
  <p>ê° train ë°ì´í„° ( train_1 ~ train_10) ëŠ” small_data.ipynb ì—ì„œ ë”°ë¡œ ì²˜ë¦¬í•˜ì—¬ ë§Œë“¤ì–´ì§.<br />
ì˜ì–´ë§Œ ì¶”ì¶œ, image_url ê³¼ caption_feature ë§Œ ì¶”ì¶œ.</p>
</blockquote>

<p>ì¶œì²˜ : https://www.kaggle.com/c/wikipedia-image-caption/code?competitionId=29705&amp;searchQuery=tensor</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># caption_featureë¥¼ ë³´ë©´
# 1. [SEP] ìœ¼ë¡œ ë‚˜ë‰˜ì–´ì ¸ ìˆëŠ”ë°, ê·¸ ë’¤ì— ìˆëŠ” ë‚´ìš©ì— ëŒ€í•´ í•  ê²ƒ. (BERT)ì—ì„œ ì‚¬ìš©í•˜ëŠ” ìŠ¤í˜ì…œ í† í°ì¸ë° íŒŒì¸íŠœë‹ì€ ì•ˆí•  ê²ƒì´ë¯€ë¡œ..
# 2. ìˆ«ìì •ë³´ëŠ” ì œì™¸í•˜ì ëŒ€ë¶€ë¶„ íŠ¹ìˆ˜í•œ ê²½ìš°ì— ì“°ì´ê±°ë‚˜ ì£¼ì†Œ ë“±ì´ë‹¤.
</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'/content/drive/MyDrive/dataset/wiki/train_1.tsv'</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'\[SEP\].+'</span><span class="p">)</span> <span class="c1"># \ë¡œ ê°ì‹¸ì§„ ê³³ì€
</span><span class="n">df</span><span class="p">[</span><span class="s">'caption_title_and_reference_description'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'caption_title_and_reference_description'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span>
                                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">'&lt;start&gt; '</span> <span class="o">+</span>
                                        <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'\d+'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">group</span><span class="p">().</span><span class="n">replace</span><span class="p">(</span><span class="s">'[SEP] '</span><span class="p">,</span> <span class="s">''</span><span class="p">)).</span><span class="n">lower</span><span class="p">()</span>
                                        <span class="o">+</span><span class="s">' &lt;end&gt;'</span>
                                        <span class="k">if</span> <span class="n">p</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">group</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span><span class="p">[</span><span class="s">'[SEP] '</span><span class="p">,</span> <span class="s">''</span><span class="p">]</span> <span class="k">else</span> <span class="bp">None</span><span class="p">)</span>
<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(301484, 2)
</code></pre></div></div>

<div id="df-e23dee60-b000-4f2a-9687-a1c1871c9bd4">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>image_url</th>
      <th>caption_title_and_reference_description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>https://upload.wikimedia.org/wikipedia/commons...</td>
      <td>&lt;start&gt; downtown deer park &lt;end&gt;</td>
    </tr>
    <tr>
      <th>1</th>
      <td>https://upload.wikimedia.org/wikipedia/commons...</td>
      <td>&lt;start&gt; jÃ¼rgen ovens's justitia, -, museumsber...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>https://upload.wikimedia.org/wikipedia/commons...</td>
      <td>&lt;start&gt;  mv agusta  raid &lt;end&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>https://upload.wikimedia.org/wikipedia/commons...</td>
      <td>&lt;start&gt; seth macfarlane's logo &lt;end&gt;</td>
    </tr>
    <tr>
      <th>6</th>
      <td>https://upload.wikimedia.org/wikipedia/commons...</td>
      <td>&lt;start&gt; erskine river at lorne &lt;end&gt;</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e23dee60-b000-4f2a-9687-a1c1871c9bd4')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e23dee60-b000-4f2a-9687-a1c1871c9bd4 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e23dee60-b000-4f2a-9687-a1c1871c9bd4');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">request</span>

<span class="k">def</span> <span class="nf">url_to_image</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="s">'''
    url ì—ì„œ ì´ë¯¸ì§€ë¥¼ ì¶”ì¶œí•˜ì—¬, (512,512,3) ì˜ rgb ndarrayë¡œ ë¦¬í„´
    '''</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'uint8'</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span><span class="c1">#/255.0
</span>    <span class="k">return</span> <span class="n">image</span>
    <span class="c1">#return cv2.resize(image, (512,512))
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ê°€ì¥ ê¸´ ìº¡ì…˜ê³¼ ê·¸ì˜ ì´ë¯¸ì§€ ì¶œë ¥í•´ë³´ê¸° (ëª¨ë¸ìƒì—ì„œëŠ” ì‹¤í–‰ì•ˆí•´ë„ë¨.)
</span><span class="kn">from</span> <span class="nn">google.colab.patches</span> <span class="kn">import</span> <span class="n">cv2_imshow</span>
<span class="n">long_caption</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'caption_title_and_reference_description'</span><span class="p">],</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'caption_title_and_reference_description'</span><span class="p">]</span> <span class="o">==</span> <span class="n">long_caption</span> <span class="p">][</span><span class="s">'image_url'</span><span class="p">]</span>
<span class="c1">#a = df[df['caption_title_and_reference_description'] == 'Downtown Deer Park']['image_url']
</span><span class="n">x</span> <span class="o">=</span> <span class="n">url_to_image</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">long_caption</span><span class="p">)</span>
<span class="n">cv2_imshow</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">long_caption</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;start&gt; figure : genomic context scheme of smrc and its closest homologues in other organisms. the Î±r rna genes are represented by red arrows and the flanking orfs by arrows on different colors depending on their product function (legend). numbers indicate the Î±r rna gene's and flanking orfs coordinates in each organism genome database. the gene strand is represented with the file direction. on the left of the figure identification names are used which correspond to a certain organism: Î±r_smrc = sinorhizobium meliloti  (nc_), Î±r_smedrc = sinorhizobium medicae wsm chromosome (nc_), Î±r_sfrc = sinorhizobium fredii ngr chromosome (nc_), Î±r_atrc = agrobacterium tumefaciens str. c chromosome linear (nc_), Î±r_reciatrc = rhizobium etli ciat  (nc_), Î±r_arrc = agrobacterium radiobacter k chromosome  (nc_), Î±r_rltrc = rhizobium leguminosarum bv. trifolii wsm (nc_), Î±r_avrc = agrobacterium vitis s chromosome  (nc_), Î±r_rlvrc = rhizobium leguminosarum bv. viciae  (nc_), Î±r_rltrc = rhizobium leguminosarum bv. trifolii wsm (nc_), Î±r_recfnrc = rhizobium etli cfn  (nc_), Î±r_mlrc = mesorhizobium loti maff chromosome (nc_), Î±r_mcrc = mesorhizobium ciceri biovar biserrulae wsm chromosome (nc_), Î±r_bcrcii = brucella canis atcc  chromosome ii (nc_), Î±r_bsrcii = brucella suis atcc  chromosome ii (nc_), Î±r_bmmrcii = brucella melitensis bv.  str. m chromosome ii (nc_), Î±r_basrcii = brucella abortus s chromosome  (nc_), Î±r_bmrcii = brucella melitensis atcc  chromosome ii (nc_), Î±r_bsrcii = brucella suis  chromosome ii (nc_), Î±r_barcii = brucella abortus bv.  str. - chromosome ii (nc_), Î±r_bmarcii = brucella melitensis biovar abortus  chromosome ii (nc_), Î±r_borcii = brucella ovis atcc  chromosome ii (nc_), Î±r_bmircii = brucella microti ccm  chromosome  (nc_), Î±r_oarc = ochrobactrum anthropi atcc  chromosome  (nc_), Î±r_msbncrc = mesorhizobium sp. bnc (nc_), Î±r_bahrc = bartonella henselae str. houston- (nc_), Î±r_bacrc = bartonella clarridgeiae  (nc_), Î±r_batrc = bartonella tribocorum cip  (nc_), Î±r_baqrc = bartonella quintana str. toulouse (nc_), Î±r_babrc = bartonella bacilliformis kc (nc_), Î±r_bagrc = bartonella grahamii asaup (nc_), Î±r_acrc = azorhizobium caulinodans ors  (nc_), Î±r_stnrc = starkeya novella dsm  chromosome (nc_), Î±r_xarc = xanthobacter autotrophicus py chromosome (nc_), Î±r_mesrc = methylocella silvestris bl chromosome (nc_), Î±r_beirc = beijerinckia indica subsp. indica atcc  chromosome (nc_), Î±r_rhprc = rhodopseudomonas palustris bisa chromosome (nc_). &lt;end&gt;
</code></pre></div></div>

<p><img src="/assets/images/project/source_2.png" width="30%" height="30%" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(7992, 1080, 3)
2492
</code></pre></div></div>

<h1 id="ì „ì²˜ë¦¬">ì „ì²˜ë¦¬</h1>
<blockquote>
  <p>ìœ„ì—ì„œ í™•ì¸í–ˆë“¯, caption ì´ ì œì¼ ê¸´ í–‰ì— ëŒ€í•´</p>
  <ol>
    <li>ì´ë¯¸ì§€ê°€ ë„ˆë¬´ í¬ë‹¤(7992,1080). &gt;  512,512 ë¡œ ì••ì¶•í•˜ê²Œ ë˜ë©´ ì‹¬ê°í•˜ê²Œ ì°Œê·¸ëŸ¬ ì§ˆê²ƒ,</li>
    <li>captionì´ ë„ˆë¬´ ê¸¸ë‹¤. 3011ì.</li>
  </ol>
</blockquote>

<blockquote>
  <p>í•´ê²°ë°©ë²•</p>
  <ol>
    <li>captionì´ ë„ˆë¬´ ê¸´ í–‰(100ì ì´ìƒ)ì€ ì‚­ì œ.</li>
    <li>image íŒŒì¼ì´ ë„ˆë¬´ í°(ê°€ë¡œ ì„¸ë¡œ ë¹„ìœ¨ì´ 2:1 í˜¹ì€ 1:2 ë¥¼ ì´ˆê³¼) ê²½ìš°ëŠ” ì‚­ì œ</li>
  </ol>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ìœ„ url_to_image ë‹¤ì‹œ ì •ì˜
</span><span class="k">def</span> <span class="nf">url_to_image</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="s">'''
    url ì—ì„œ ì´ë¯¸ì§€ë¥¼ ì¶”ì¶œí•˜ì—¬, (512,512,3) ì˜ rgb ndarrayë¡œ ë¦¬í„´
    '''</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'uint8'</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span><span class="c1">#/255.0
</span>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="bp">None</span><span class="p">])</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">/</span><span class="mf">255.0</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">image</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">image</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="n">image</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">image</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="p">):</span>  <span class="c1"># ê°€ë¡œì„¸ë¡œ ë¹„ìœ¨ì´ 1:2, 2:1ì„ ë²—ì–´ë‚œë‹¤ë©´
</span>        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="bp">None</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cv2</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">299</span><span class="p">,</span><span class="mi">299</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_pre_train</span><span class="o">=</span><span class="p">[]</span>
<span class="n">y_train</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">((</span><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1500</span><span class="p">:</span><span class="mi">2000</span><span class="p">][</span><span class="s">'image_url'</span><span class="p">])):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">url_to_image</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">if</span> <span class="bp">None</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="n">X_pre_train</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
          <span class="n">y_train</span><span class="p">.</span><span class="n">append</span><span class="p">(</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'caption_title_and_reference_description'</span><span class="p">]</span> <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
          <span class="k">pass</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_pre_train</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">X_pre_train</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">y_train</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># png íŒŒì¼ì¼ ê²½ìš° libpngê²½ê³ ê°€ ë‚˜ì˜¤ëŠ”ë° ë¬´ì‹œí•´ë„ ì¢‹ì„ë“¯í•˜ë‹¤.
# srv íŒŒì¼ì˜ ê²½ìš°
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>388
(299, 299, 3)
388
&lt;start&gt;  mv agusta  raid &lt;end&gt;
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">image_model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">applications</span><span class="p">.</span><span class="n">InceptionV3</span><span class="p">(</span><span class="n">include_top</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                                <span class="n">weights</span><span class="o">=</span><span class="s">'imagenet'</span><span class="p">)</span>
<span class="n">new_input</span> <span class="o">=</span> <span class="n">image_model</span><span class="p">.</span><span class="nb">input</span>
<span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">image_model</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">output</span>

<span class="n">image_features_extract_model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Model</span><span class="p">(</span><span class="n">new_input</span><span class="p">,</span> <span class="n">hidden_layer</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Downloading data from https://storage.googleapis.com/tensorflow/keras-applications/inception_v3/inception_v3_weights_tf_dim_ordering_tf_kernels_notop.h5
87916544/87910968 [==============================] - 1s 0us/step
87924736/87910968 [==============================] - 1s 0us/step
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># imagenet ê°€ì¤‘ì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì„±ì¶”ì¶œ
</span><span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">image_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">Dataset</span><span class="p">.</span><span class="n">from_tensor_slices</span><span class="p">(</span><span class="n">X_pre_train</span><span class="p">)</span>
<span class="n">image_dataset</span> <span class="o">=</span> <span class="n">image_dataset</span><span class="p">.</span><span class="n">batch</span><span class="p">(</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
<span class="n">np_batch_features</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">64</span><span class="p">,</span><span class="mi">2048</span><span class="p">))])</span>   <span class="c1"># ì—¬ê¸°ì„œ 64ëŠ” batch_sizeê°€ ì•„ë‹ˆë¼ InceptionV3ì˜ ë§ˆì§€ë§‰ ë ˆì´ì–´ ì•„ì›ƒí’‹ ëª¨ì–‘
</span><span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">image_dataset</span><span class="p">:</span>
    <span class="n">batch_features</span> <span class="o">=</span> <span class="n">image_features_extract_model</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="n">batch_features</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">batch_features</span><span class="p">,</span>
                              <span class="p">(</span><span class="n">batch_features</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_features</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">temp_img</span> <span class="ow">in</span> <span class="n">batch_features</span><span class="p">:</span>
      <span class="n">np_batch_features</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">np_batch_features</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp_img</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">2048</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">np_batch_features</span> <span class="o">=</span> <span class="n">np_batch_features</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np_batch_features</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(388, 64, 2048)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># y_train ì€ ìº¡ì…˜ ë¬¸ì¥ì¸ë°, í† í¬ë‚˜ì´ì €ë¥¼ í†µí•´ ë¬¸ì¥ë“¤ì„ ë‹¨ì–´ë³„ ë²¡í„°í™” í•´ì¤€ë‹¤. (cap_vector)
</span>
<span class="n">top_k</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">preprocessing</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">Tokenizer</span><span class="p">(</span><span class="n">num_words</span><span class="o">=</span><span class="n">top_k</span><span class="p">,</span>
                                                  <span class="n">oov_token</span><span class="o">=</span><span class="s">"&lt;unk&gt;"</span><span class="p">,</span>
                                                  <span class="n">filters</span><span class="o">=</span><span class="s">'!"#$%&amp;*+.-;?@[]^`{}~ '</span><span class="p">)</span>
<span class="n">tokenizer</span><span class="p">.</span><span class="n">fit_on_texts</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">train_seqs</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="p">.</span><span class="n">texts_to_sequences</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">cap_vector</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">preprocessing</span><span class="p">.</span><span class="n">sequence</span><span class="p">.</span><span class="n">pad_sequences</span><span class="p">(</span><span class="n">train_seqs</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">'post'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">y_train</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cap_vector</span><span class="p">))</span>
<span class="n">cap_vector</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;start&gt; erskine river at lorne &lt;end&gt;
388





array([  2, 304,  31,   9, 305,   3,   0,   0,   0,   0,   0,   0,   0,
         0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
         0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
         0,   0,   0,   0,   0,   0,   0,   0,   0], dtype=int32)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#size_test = int( 0.01 * len(cap_vector))
</span><span class="n">size_test</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># test ëŠ” ë”± ë§ˆì§€ë§‰ì— í™•ì¸ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ì.
</span><span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">np_batch_features</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="n">size_test</span><span class="p">]</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">np_batch_features</span><span class="p">)[</span><span class="n">size_test</span><span class="p">:]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">cap_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">size_test</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">cap_vector</span><span class="p">[</span><span class="n">size_test</span><span class="p">:]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(1, 1, 387, 387)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_test</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(1, 64, 2048)
</code></pre></div></div>

<h1 id="ì „ì—­ë³€ìˆ˜">ì „ì—­ë³€ìˆ˜</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">BUFFER_SIZE</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">embedding_dim</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">units</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">vocab_size</span> <span class="o">=</span> <span class="n">top_k</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="o">//</span> <span class="n">BATCH_SIZE</span>
<span class="n">features_shape</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">attention_features_shape</span> <span class="o">=</span> <span class="mi">64</span>
</code></pre></div></div>

<h2 id="ë°ì´í„°ì…‹-ì§€ì •">ë°ì´í„°ì…‹ ì§€ì •</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">Dataset</span><span class="p">.</span><span class="n">from_tensor_slices</span><span class="p">((</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">BUFFER_SIZE</span><span class="p">).</span><span class="n">batch</span><span class="p">(</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="optimizer-loss-func">optimizer, loss func..</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">optimizers</span><span class="p">.</span><span class="n">Adam</span><span class="p">()</span>
<span class="n">loss_object</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">losses</span><span class="p">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span>
    <span class="n">from_logits</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s">'none'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">loss_function</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="n">pred</span><span class="p">):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">math</span><span class="p">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">math</span><span class="p">.</span><span class="n">equal</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">loss_</span> <span class="o">=</span> <span class="n">loss_object</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">cast</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">loss_</span><span class="p">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">loss_</span> <span class="o">*=</span> <span class="n">mask</span>

    <span class="k">return</span> <span class="n">tf</span><span class="p">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">loss_</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="model-ì •ì˜">model ì •ì˜</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">BahdanauAttention</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
    <span class="s">'''
    W1, W2, V ëŠ” í•™ìŠµê°€ëŠ¥í•œ ê°€ì¤‘ì¹˜ë²¡í„°
    '''</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">BahdanauAttention</span><span class="p">,</span> <span class="bp">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span>   <span class="c1"># ë¶€ëª¨í´ë˜ìŠ¤ (tf.keras.Model.init()ì‚¬ìš©)
</span>    <span class="bp">self</span><span class="p">.</span><span class="n">W1</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>      <span class="c1"># units(ì „ì—­) ìˆ˜ ì˜ nodeë¥¼ ê°–ëŠ” W1 ê°€ì¤‘ì¹˜
</span>    <span class="bp">self</span><span class="p">.</span><span class="n">W2</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>      <span class="c1"># ìœ„ì™€ ë™ w2 ê°€ì¤‘ì¹˜
</span>    <span class="bp">self</span><span class="p">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>           <span class="c1"># Vê°€ì¤‘ì¹˜ëŠ” í•˜ë‚˜ë¡œ.
</span>
  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">hidden</span><span class="p">):</span>
    <span class="s">'''
    feautures : ì´ë¯¸ì§€ì˜ í”¼ì³ë§µ
    hidden : hidden state
    '''</span>
    <span class="n">hidden_with_time_axis</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">hidden</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">attention_hidden_layer</span> <span class="o">=</span> <span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">tanh</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">W1</span><span class="p">(</span><span class="n">features</span><span class="p">)</span> <span class="o">+</span>
                                         <span class="bp">self</span><span class="p">.</span><span class="n">W2</span><span class="p">(</span><span class="n">hidden_with_time_axis</span><span class="p">)))</span>
    <span class="n">score</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">V</span><span class="p">(</span><span class="n">attention_hidden_layer</span><span class="p">)</span>
    <span class="n">attention_weights</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">context_vector</span> <span class="o">=</span> <span class="n">attention_weights</span> <span class="o">*</span> <span class="n">features</span>
    <span class="n">context_vector</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">context_vector</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">context_vector</span><span class="p">,</span> <span class="n">attention_weights</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">CNN_Encoder</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CNN_Encoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">embedding_dim</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">fc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">RNN_Decoder</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">RNN_Decoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>

    <span class="bp">self</span><span class="p">.</span><span class="n">embedding</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span><span class="n">embedding_dim</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">gru</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">GRU</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">units</span><span class="p">,</span>
                                   <span class="n">return_sequences</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                   <span class="n">return_state</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                   <span class="n">recurrent_initializer</span><span class="o">=</span><span class="s">'glorot_uniform'</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">units</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">)</span>

    <span class="bp">self</span><span class="p">.</span><span class="n">attention</span> <span class="o">=</span> <span class="n">BahdanauAttention</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">units</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">hidden</span><span class="p">):</span>
    <span class="n">context_vector</span><span class="p">,</span> <span class="n">attention_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">attention</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">hidden</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">embedding</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">tf</span><span class="p">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">context_vector</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">output</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">gru</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">attention_weights</span>

  <span class="k">def</span> <span class="nf">reset_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">tf</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">units</span><span class="p">))</span>
</code></pre></div></div>

<h1 id="trian-step-ì •ì˜">trian step ì •ì˜</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">encoder</span> <span class="o">=</span> <span class="n">CNN_Encoder</span><span class="p">(</span><span class="n">embedding_dim</span><span class="p">)</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">RNN_Decoder</span><span class="p">(</span><span class="n">embedding_dim</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">checkpoint_path</span> <span class="o">=</span> <span class="s">"./drive/MyDrive/dataset/wiki/checkpoints/train"</span>
<span class="n">ckpt</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">train</span><span class="p">.</span><span class="n">Checkpoint</span><span class="p">(</span><span class="n">encoder</span><span class="o">=</span><span class="n">encoder</span><span class="p">,</span>
                           <span class="n">decoder</span><span class="o">=</span><span class="n">decoder</span><span class="p">,</span>
                           <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">)</span>
<span class="n">ckpt_manager</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">train</span><span class="p">.</span><span class="n">CheckpointManager</span><span class="p">(</span><span class="n">ckpt</span><span class="p">,</span> <span class="n">checkpoint_path</span><span class="p">,</span> <span class="n">max_to_keep</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">start_epoch</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">if</span> <span class="n">ckpt_manager</span><span class="p">.</span><span class="n">latest_checkpoint</span><span class="p">:</span>
  <span class="n">start_epoch</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ckpt_manager</span><span class="p">.</span><span class="n">latest_checkpoint</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'-'</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
  <span class="c1"># restoring the latest checkpoint in checkpoint_path
</span>  <span class="n">ckpt</span><span class="p">.</span><span class="n">restore</span><span class="p">(</span><span class="n">ckpt_manager</span><span class="p">.</span><span class="n">latest_checkpoint</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># adding this in a separate cell because if you run the training cell
# many times, the loss_plot array will be reset
</span><span class="n">loss_plot</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">tf</span><span class="p">.</span><span class="n">function</span>
<span class="k">def</span> <span class="nf">train_step</span><span class="p">(</span><span class="n">img_tensor</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
  <span class="n">loss</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="c1"># initializing the hidden state for each batch
</span>  <span class="c1"># because the captions are not related from image to image
</span>  <span class="n">hidden</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">.</span><span class="n">reset_state</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

  <span class="n">dec_input</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">expand_dims</span><span class="p">([</span><span class="n">tokenizer</span><span class="p">.</span><span class="n">word_index</span><span class="p">[</span><span class="s">'&lt;start&gt;'</span><span class="p">]]</span> <span class="o">*</span> <span class="n">target</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

  <span class="k">with</span> <span class="n">tf</span><span class="p">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
      <span class="n">features</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">img_tensor</span><span class="p">)</span>

      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">target</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
          <span class="c1"># passing the features through the decoder
</span>          <span class="n">predictions</span><span class="p">,</span> <span class="n">hidden</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">(</span><span class="n">dec_input</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">hidden</span><span class="p">)</span>

          <span class="n">loss</span> <span class="o">+=</span> <span class="n">loss_function</span><span class="p">(</span><span class="n">target</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)</span>

          <span class="c1"># using teacher forcing
</span>          <span class="n">dec_input</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">target</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

  <span class="n">total_loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">loss</span> <span class="o">/</span> <span class="nb">int</span><span class="p">(</span><span class="n">target</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

  <span class="n">trainable_variables</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">.</span><span class="n">trainable_variables</span> <span class="o">+</span> <span class="n">decoder</span><span class="p">.</span><span class="n">trainable_variables</span>

  <span class="n">gradients</span> <span class="o">=</span> <span class="n">tape</span><span class="p">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">trainable_variables</span><span class="p">)</span>

  <span class="n">optimizer</span><span class="p">.</span><span class="n">apply_gradients</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">gradients</span><span class="p">,</span> <span class="n">trainable_variables</span><span class="p">))</span>

  <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">total_loss</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">20</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_epoch</span><span class="p">,</span> <span class="n">EPOCHS</span><span class="p">):</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">total_loss</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="p">(</span><span class="n">img_tensor</span><span class="p">,</span> <span class="n">target</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
        <span class="n">batch_loss</span><span class="p">,</span> <span class="n">t_loss</span> <span class="o">=</span> <span class="n">train_step</span><span class="p">(</span><span class="n">img_tensor</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="n">total_loss</span> <span class="o">+=</span> <span class="n">t_loss</span>

        <span class="k">if</span> <span class="n">batch</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">average_batch_loss</span> <span class="o">=</span> <span class="n">batch_loss</span><span class="p">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">/</span><span class="nb">int</span><span class="p">(</span><span class="n">target</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s"> Batch </span><span class="si">{</span><span class="n">batch</span><span class="si">}</span><span class="s"> Loss </span><span class="si">{</span><span class="n">average_batch_loss</span><span class="p">:.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
    <span class="c1"># storing the epoch end loss value to plot later
</span>    <span class="n">loss_plot</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_loss</span> <span class="o">/</span> <span class="n">num_steps</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">epoch</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">ckpt_manager</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>

    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s"> Loss </span><span class="si">{</span><span class="n">total_loss</span><span class="o">/</span><span class="n">num_steps</span><span class="p">:.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Time taken for 1 epoch </span><span class="si">{</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">start</span><span class="p">:.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> sec</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Epoch 5 Batch 0 Loss 1.7554
Epoch 5 Loss 1.809353
Time taken for 1 epoch 157.57 sec

Epoch 6 Batch 0 Loss 1.1847
Epoch 6 Loss 1.441257
Time taken for 1 epoch 46.38 sec

Epoch 7 Batch 0 Loss 1.0604
Epoch 7 Loss 1.354600
Time taken for 1 epoch 45.60 sec

Epoch 8 Batch 0 Loss 1.2198
Epoch 8 Loss 1.334983
Time taken for 1 epoch 45.94 sec

Epoch 9 Batch 0 Loss 1.0771
Epoch 9 Loss 1.477467
Time taken for 1 epoch 46.14 sec

Epoch 10 Batch 0 Loss 1.2247
Epoch 10 Loss 1.347626
Time taken for 1 epoch 45.70 sec

Epoch 11 Batch 0 Loss 1.0726
Epoch 11 Loss 1.260275
Time taken for 1 epoch 46.71 sec

Epoch 12 Batch 0 Loss 1.2278
Epoch 12 Loss 1.200646
Time taken for 1 epoch 46.94 sec

Epoch 13 Batch 0 Loss 1.2482
Epoch 13 Loss 1.216185
Time taken for 1 epoch 46.13 sec

Epoch 14 Batch 0 Loss 1.0949
Epoch 14 Loss 1.133379
Time taken for 1 epoch 45.98 sec

Epoch 15 Batch 0 Loss 1.1599
Epoch 15 Loss 1.292254
Time taken for 1 epoch 46.25 sec

Epoch 16 Batch 0 Loss 0.9927
Epoch 16 Loss 1.213316
Time taken for 1 epoch 46.76 sec

Epoch 17 Batch 0 Loss 1.0226
Epoch 17 Loss 1.102528
Time taken for 1 epoch 46.03 sec

Epoch 18 Batch 0 Loss 0.8826
Epoch 18 Loss 1.238099
Time taken for 1 epoch 46.58 sec

Epoch 19 Batch 0 Loss 0.8167
Epoch 19 Loss 1.090817
Time taken for 1 epoch 47.73 sec

Epoch 20 Batch 0 Loss 0.8715
Epoch 20 Loss 1.050230
Time taken for 1 epoch 48.49 sec
</code></pre></div></div>

<h1 id="ì˜ˆì¸¡-ëª¨ë¸">ì˜ˆì¸¡ ëª¨ë¸</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">calc_max_length</span><span class="p">(</span><span class="n">tensor</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tensor</span><span class="p">)</span>

<span class="n">max_length</span> <span class="o">=</span> <span class="n">max_length</span> <span class="o">=</span> <span class="n">calc_max_length</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">attention_plot</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">max_length</span><span class="p">,</span> <span class="n">attention_features_shape</span><span class="p">))</span>

    <span class="n">hidden</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">.</span><span class="n">reset_state</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">temp_input</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">url_to_image</span><span class="p">(</span><span class="n">image</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">img_tensor_val</span> <span class="o">=</span> <span class="n">image_features_extract_model</span><span class="p">(</span><span class="n">temp_input</span><span class="p">)</span>
    <span class="n">img_tensor_val</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">img_tensor_val</span><span class="p">,</span> <span class="p">(</span><span class="n">img_tensor_val</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                 <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                                 <span class="n">img_tensor_val</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>

    <span class="n">features</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">img_tensor_val</span><span class="p">)</span>

    <span class="n">dec_input</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">expand_dims</span><span class="p">([</span><span class="n">tokenizer</span><span class="p">.</span><span class="n">word_index</span><span class="p">[</span><span class="s">'&lt;start&gt;'</span><span class="p">]],</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">):</span>
        <span class="n">predictions</span><span class="p">,</span> <span class="n">hidden</span><span class="p">,</span> <span class="n">attention_weights</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">(</span><span class="n">dec_input</span><span class="p">,</span>
                                                         <span class="n">features</span><span class="p">,</span>
                                                         <span class="n">hidden</span><span class="p">)</span>

        <span class="n">attention_plot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">attention_weights</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">)).</span><span class="n">numpy</span><span class="p">()</span>

        <span class="n">predicted_id</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">categorical</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">numpy</span><span class="p">()</span>
        <span class="n">result</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">.</span><span class="n">index_word</span><span class="p">[</span><span class="n">predicted_id</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">tokenizer</span><span class="p">.</span><span class="n">index_word</span><span class="p">[</span><span class="n">predicted_id</span><span class="p">]</span> <span class="o">==</span> <span class="s">'&lt;end&gt;'</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">attention_plot</span>

        <span class="n">dec_input</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">expand_dims</span><span class="p">([</span><span class="n">predicted_id</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">attention_plot</span> <span class="o">=</span> <span class="n">attention_plot</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">attention_plot</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># captions on the validation set
</span><span class="n">image_url</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'image_url'</span><span class="p">][</span><span class="mi">20</span><span class="p">]</span>
<span class="n">real_caption</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'caption_title_and_reference_description'</span><span class="p">][</span><span class="mi">20</span><span class="p">]</span>
<span class="n">result</span><span class="p">,</span> <span class="n">attention_plot</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>

<span class="n">cv2_imshow</span><span class="p">(</span><span class="n">url_to_image</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span><span class="o">*</span><span class="mi">255</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Real Caption:'</span><span class="p">,</span> <span class="n">real_caption</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Prediction Caption:'</span><span class="p">,</span> <span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</code></pre></div></div>

<p><img src="/assets/images/project/source_3.png" width="50%" height="50%" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Real Caption: &lt;start&gt; entering a mining settlement from jamieson &lt;end&gt;
Prediction Caption: a np on either may river the wyndham's &lt;end&gt;
</code></pre></div></div>

<h1 id="ê²°ê³¼-í•´ì„">ê²°ê³¼ í•´ì„</h1>
<ol>
  <li>ê´‘ì‚° ì…êµ¬ ê¸¸ì— ëŒ€í•œ ì´ë¯¸ì§€ë¥¼ â€˜wyndhamì˜ riverâ€™ ì •ë„ì˜ ìº¡ì…˜ì„ ìƒì„±í–ˆë‹¤.</li>
  <li>ê¸¸ì˜ ìƒ‰ê¹”ë§Œ ë‹¤ë¥´ë‹¤ë©´ ì¶©ë¶„íˆ ê°•ìœ¼ë¡œ ì¸ì‹í•  ìˆ˜ ìˆëŠ” ìˆ˜ì¤€ì¼ ê²ƒ. ë¬¼ë¡  ì„±ê³µì ì¸ ê²°ê³¼ë¼ê³  ë³´ê¸´ í˜ë“¤ë‹¤.</li>
</ol>

<h1 id="ê°œì„ í• -ì ">ê°œì„ í•  ì </h1>
<ol>
  <li>kaggleì˜ wikií•™ìŠµë°ì´í„°ê°€ ë„ˆë¬´ ë°©ëŒ€í•˜ë‹¤ ë³´ë‹ˆ, ì¼ë¶€ë¥¼ ìª¼ê°œì–´ ì‚¬ìš©í•˜ê¸°ë„ í–ˆê³ , ìº¡ì…˜ì˜ ê²½ìš° ë„ˆë¬´ ë””í…Œì¼(ì§€ëª…ì´ ë“¤ì–´ê°„ë‹¤ë˜ê°€ ë“±)í•œ ë¶€ë¶„ì„ ì—†ì• ëŠ” ê³¼ì •ì´ í•„ìš”í–ˆë‹¤ê³  ìƒê°í•œë‹¤. (í†µê³„ì  ì–¸ì–´ëª¨ë¸)</li>
  <li>í•™ìŠµë°ì´í„°ì˜ ì¦ê°•ì´ ë” í•„ìš”í–ˆë‹¤ê³  ìƒê°í•œë‹¤. (ìƒ‰ì±„ ë³€ê²½, íšŒì „ ë“±)</li>
  <li>ì „ì²´ êµ¬ì¡°ë¥¼ ì¢€ ë” ìª¼ê°œì„œ ì‚¬ìš©í•  ê±¸ ì‹¶ë‹¤. ì˜ˆë¥¼ ë“¤ë©´ training.py ìœ¼ë¡œ ê°€ì¤‘ì¹˜íŒŒì¼ì„ ìƒì„±í•œë‹¤ê±°ë‚˜, main.py result.py ë“± ìœ¼ë¡œ í•˜ì—¬ ê°€ì‹œì„±, ì ‘ê·¼ì„±ì„ ë†’ì´ëŠ” ê²Œ í•„ìš”í•´ë³´ì¸ë‹¤. (ì´ í”„ë¡œì íŠ¸ëŠ” ëª‡ë‹¬ ì „ì— ì‹œë„í–ˆë˜ ê²ƒì´ê¸° ë–„ë¬¸ì— ë¶€ì¡±í•œì ì´ ë§ì´ ë³´ì´ëŠ” ë“¯ í•˜ë‹¤.)</li>
</ol>

<p><br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš°
ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„
</code></pre></div></div>

<p><a href="#" class="btn btn--primary align-right">ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°</a></p>]]></content><author><name>ì˜¹ë‹¬ìƒ˜ğŸ‘±ğŸ¼â€â™‚ï¸</name></author><category term="pj" /><category term="attention" /><category term="RNN" /><summary type="html"><![CDATA[mac gpu ì‚¬ìš©ê°€ëŠ¥í™•ì¸ (1ì´ë©´ ì‚¬ìš©ê°€ëŠ¥)]]></summary></entry><entry><title type="html">ë¹„í–‰ê¸° í‘¯ê°’ ì˜ˆì¸¡ MLP(Multi Layer Perceptron)</title><link href="http://localhost:4000/pj/airplane_price/" rel="alternate" type="text/html" title="ë¹„í–‰ê¸° í‘¯ê°’ ì˜ˆì¸¡ MLP(Multi Layer Perceptron)" /><published>2022-03-26T00:00:00+09:00</published><updated>2022-03-26T00:00:00+09:00</updated><id>http://localhost:4000/pj/airplane_price</id><content type="html" xml:base="http://localhost:4000/pj/airplane_price/"><![CDATA[<h1 id="íŒë‹¤ìŠ¤-í”„ë¡œíŒŒì¼ë§-ì½”ë©ì—ì„œ-ì‘ë™í•˜ë„ë¡-ë²„ì „ì§€ì •-ì„¤ì¹˜">íŒë‹¤ìŠ¤ í”„ë¡œíŒŒì¼ë§ ì½”ë©ì—ì„œ ì‘ë™í•˜ë„ë¡ ë²„ì „ì§€ì • ì„¤ì¹˜</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pandas</span><span class="o">==</span><span class="mf">1.2</span><span class="p">.</span><span class="mi">1</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pandas_profiling</span><span class="o">==</span><span class="mf">2.8</span><span class="p">.</span><span class="mi">0</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Collecting pandas==1.2.1
  Downloading pandas-1.2.1-cp37-cp37m-manylinux1_x86_64.whl (9.9 MB)
[K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9.9 MB 9.8 MB/s
[?25hRequirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas==1.2.1) (2018.9)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas==1.2.1) (2.8.2)
Requirement already satisfied: numpy&gt;=1.16.5 in /usr/local/lib/python3.7/dist-packages (from pandas==1.2.1) (1.21.5)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.7.3-&gt;pandas==1.2.1) (1.15.0)
Installing collected packages: pandas
  Attempting uninstall: pandas
    Found existing installation: pandas 1.3.5
    Uninstalling pandas-1.3.5:
      Successfully uninstalled pandas-1.3.5
[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
google-colab 1.0.0 requires requests~=2.23.0, but you have requests 2.27.1 which is incompatible.[0m
Successfully installed pandas-1.2.1




Requirement already satisfied: pandas_profiling==2.8.0 in /usr/local/lib/python3.7/dist-packages (2.8.0)
Requirement already satisfied: jinja2&gt;=2.11.1 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (2.11.3)
Requirement already satisfied: missingno&gt;=0.4.2 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (0.5.1)
Requirement already satisfied: numpy&gt;=1.16.0 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (1.21.5)
Requirement already satisfied: htmlmin&gt;=0.1.12 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (0.1.12)
Requirement already satisfied: visions[type_image_path]==0.4.4 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (0.4.4)
Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (1.0.1)
Requirement already satisfied: pandas!=1.0.0,!=1.0.1,!=1.0.2,&gt;=0.25.3 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (1.2.1)
Requirement already satisfied: scipy&gt;=1.4.1 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (1.7.3)
Requirement already satisfied: phik&gt;=0.9.10 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (0.12.2)
Requirement already satisfied: tangled-up-in-unicode&gt;=0.0.6 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (0.1.0)
Requirement already satisfied: matplotlib&gt;=3.2.0 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (3.2.2)
Requirement already satisfied: requests&gt;=2.23.0 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (2.27.1)
Requirement already satisfied: tqdm&gt;=4.43.0 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (4.63.0)
Requirement already satisfied: confuse&gt;=1.0.0 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (1.7.0)
Requirement already satisfied: astropy&gt;=4.0 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (4.3.1)
Requirement already satisfied: ipywidgets&gt;=7.5.1 in /usr/local/lib/python3.7/dist-packages (from pandas_profiling==2.8.0) (7.7.0)
Requirement already satisfied: attrs&gt;=19.3.0 in /usr/local/lib/python3.7/dist-packages (from visions[type_image_path]==0.4.4-&gt;pandas_profiling==2.8.0) (21.4.0)
Requirement already satisfied: networkx&gt;=2.4 in /usr/local/lib/python3.7/dist-packages (from visions[type_image_path]==0.4.4-&gt;pandas_profiling==2.8.0) (2.6.3)
Requirement already satisfied: imagehash in /usr/local/lib/python3.7/dist-packages (from visions[type_image_path]==0.4.4-&gt;pandas_profiling==2.8.0) (4.2.1)
Requirement already satisfied: Pillow in /usr/local/lib/python3.7/dist-packages (from visions[type_image_path]==0.4.4-&gt;pandas_profiling==2.8.0) (7.1.2)
Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from astropy&gt;=4.0-&gt;pandas_profiling==2.8.0) (4.11.3)
Requirement already satisfied: pyerfa&gt;=1.7.3 in /usr/local/lib/python3.7/dist-packages (from astropy&gt;=4.0-&gt;pandas_profiling==2.8.0) (2.0.0.1)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from confuse&gt;=1.0.0-&gt;pandas_profiling==2.8.0) (6.0)
Requirement already satisfied: ipython&gt;=4.0.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (5.5.0)
Requirement already satisfied: widgetsnbextension~=3.6.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (3.6.0)
Requirement already satisfied: nbformat&gt;=4.2.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (5.2.0)
Requirement already satisfied: ipykernel&gt;=4.5.1 in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (4.10.1)
Requirement already satisfied: traitlets&gt;=4.3.1 in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (5.1.1)
Requirement already satisfied: ipython-genutils~=0.2.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (0.2.0)
Requirement already satisfied: jupyterlab-widgets&gt;=1.0.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (1.1.0)
Requirement already satisfied: tornado&gt;=4.0 in /usr/local/lib/python3.7/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (5.1.1)
Requirement already satisfied: jupyter-client in /usr/local/lib/python3.7/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (5.3.5)
Requirement already satisfied: decorator in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (4.4.2)
Requirement already satisfied: pygments in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (2.6.1)
Requirement already satisfied: prompt-toolkit&lt;2.0.0,&gt;=1.0.4 in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (1.0.18)
Requirement already satisfied: simplegeneric&gt;0.8 in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (0.8.1)
Requirement already satisfied: setuptools&gt;=18.5 in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (57.4.0)
Requirement already satisfied: pickleshare in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (0.7.5)
Requirement already satisfied: pexpect in /usr/local/lib/python3.7/dist-packages (from ipython&gt;=4.0.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (4.8.0)
Requirement already satisfied: MarkupSafe&gt;=0.23 in /usr/local/lib/python3.7/dist-packages (from jinja2&gt;=2.11.1-&gt;pandas_profiling==2.8.0) (2.0.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.2.0-&gt;pandas_profiling==2.8.0) (1.4.0)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.2.0-&gt;pandas_profiling==2.8.0) (3.0.7)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.2.0-&gt;pandas_profiling==2.8.0) (0.11.0)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.2.0-&gt;pandas_profiling==2.8.0) (2.8.2)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from kiwisolver&gt;=1.0.1-&gt;matplotlib&gt;=3.2.0-&gt;pandas_profiling==2.8.0) (3.10.0.2)
Requirement already satisfied: seaborn in /usr/local/lib/python3.7/dist-packages (from missingno&gt;=0.4.2-&gt;pandas_profiling==2.8.0) (0.11.2)
Requirement already satisfied: jsonschema!=2.5.0,&gt;=2.4 in /usr/local/lib/python3.7/dist-packages (from nbformat&gt;=4.2.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (4.3.3)
Requirement already satisfied: jupyter-core in /usr/local/lib/python3.7/dist-packages (from nbformat&gt;=4.2.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (4.9.2)
Requirement already satisfied: importlib-resources&gt;=1.4.0 in /usr/local/lib/python3.7/dist-packages (from jsonschema!=2.5.0,&gt;=2.4-&gt;nbformat&gt;=4.2.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (5.4.0)
Requirement already satisfied: pyrsistent!=0.17.0,!=0.17.1,!=0.17.2,&gt;=0.14.0 in /usr/local/lib/python3.7/dist-packages (from jsonschema!=2.5.0,&gt;=2.4-&gt;nbformat&gt;=4.2.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (0.18.1)
Requirement already satisfied: zipp&gt;=3.1.0 in /usr/local/lib/python3.7/dist-packages (from importlib-resources&gt;=1.4.0-&gt;jsonschema!=2.5.0,&gt;=2.4-&gt;nbformat&gt;=4.2.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (3.7.0)
Requirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas!=1.0.0,!=1.0.1,!=1.0.2,&gt;=0.25.3-&gt;pandas_profiling==2.8.0) (2018.9)
Requirement already satisfied: wcwidth in /usr/local/lib/python3.7/dist-packages (from prompt-toolkit&lt;2.0.0,&gt;=1.0.4-&gt;ipython&gt;=4.0.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (0.2.5)
Requirement already satisfied: six&gt;=1.9.0 in /usr/local/lib/python3.7/dist-packages (from prompt-toolkit&lt;2.0.0,&gt;=1.0.4-&gt;ipython&gt;=4.0.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (1.15.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.23.0-&gt;pandas_profiling==2.8.0) (2021.10.8)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.23.0-&gt;pandas_profiling==2.8.0) (2.10)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.23.0-&gt;pandas_profiling==2.8.0) (1.24.3)
Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.23.0-&gt;pandas_profiling==2.8.0) (2.0.12)
Requirement already satisfied: notebook&gt;=4.4.1 in /usr/local/lib/python3.7/dist-packages (from widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (5.3.1)
Requirement already satisfied: terminado&gt;=0.8.1 in /usr/local/lib/python3.7/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (0.13.3)
Requirement already satisfied: nbconvert in /usr/local/lib/python3.7/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (5.6.1)
Requirement already satisfied: Send2Trash in /usr/local/lib/python3.7/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (1.8.0)
Requirement already satisfied: pyzmq&gt;=13 in /usr/local/lib/python3.7/dist-packages (from jupyter-client-&gt;ipykernel&gt;=4.5.1-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (22.3.0)
Requirement already satisfied: ptyprocess in /usr/local/lib/python3.7/dist-packages (from terminado&gt;=0.8.1-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (0.7.0)
Requirement already satisfied: PyWavelets in /usr/local/lib/python3.7/dist-packages (from imagehash-&gt;visions[type_image_path]==0.4.4-&gt;pandas_profiling==2.8.0) (1.3.0)
Requirement already satisfied: pandocfilters&gt;=1.4.1 in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (1.5.0)
Requirement already satisfied: defusedxml in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (0.7.1)
Requirement already satisfied: entrypoints&gt;=0.2.2 in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (0.4)
Requirement already satisfied: bleach in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (4.1.0)
Requirement already satisfied: testpath in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (0.6.0)
Requirement already satisfied: mistune&lt;2,&gt;=0.8.1 in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (0.8.4)
Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from bleach-&gt;nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (21.3)
Requirement already satisfied: webencodings in /usr/local/lib/python3.7/dist-packages (from bleach-&gt;nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets&gt;=7.5.1-&gt;pandas_profiling==2.8.0) (0.5.1)
</code></pre></div></div>

<h1 id="ë°ì´í„°-ë¶ˆëŸ¬ì˜¤ê¸°">ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">pandas_profiling</span> <span class="kn">import</span> <span class="n">ProfileReport</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">CSV_PATH_1</span> <span class="o">=</span> <span class="s">'/content/drive/MyDrive/dataset/airplane/Data_Train.csv'</span>
<span class="n">CSV_PATH_2</span> <span class="o">=</span> <span class="s">'/content/drive/MyDrive/dataset/airplane/Test_set.csv'</span>
<span class="n">CSV_PATH_3</span> <span class="o">=</span> <span class="s">'/content/drive/MyDrive/dataset/airplane/Sample_submission.csv'</span>
<span class="n">target</span> <span class="o">=</span> <span class="s">'Price'</span>
</code></pre></div></div>

<h1 id="ë°ì´í„°-ì—”ì§€ë‹ˆì–´">ë°ì´í„° ì—”ì§€ë‹ˆì–´</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># feature ìˆ˜ 10ê°œ.
</span><span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">CSV_PATH_1</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">CSV_PATH_2</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">CSV_PATH_3</span><span class="p">)</span>
<span class="s">"""
ì „ì²˜ë¦¬
1. Airline : one-hot encoding
2. Date_of_Journey : ì‚­ì œ
3. Source : one-hot encoding
4. Destination : one-hot encoding
5. Route : ì‚­ì œí•˜ì
6. Dep_Time : h*60 + min ìœ¼ë¡œ ì¹˜í™˜
7. Arrival_Time : ìœ„ì™€ ë™
8. Duration : ìœ„ì™€ë™
9. Total_Stops : ìˆ«ìë§Œ ë‚¨ê¸°ì non-stopì€ 0
10. Additional_Info : one-hot encoding
"""</span>

<span class="c1"># Route  Date_of_journey ì‚­ì œ
</span><span class="n">X_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'Date_of_Journey'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_test</span><span class="o">=</span><span class="n">X_test</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'Date_of_Journey'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'Route'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_test</span><span class="o">=</span><span class="n">X_test</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'Route'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># íƒ‘ìŠ¹, ë„ì°© ì‹œê°„ê³„ì‚°
</span><span class="k">def</span> <span class="nf">hour_cal</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s">'(\d+):'</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s">':(\d+)'</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">hour</span><span class="o">*</span><span class="mi">60</span><span class="o">+</span><span class="n">minute</span>
<span class="n">X_train</span><span class="p">[</span><span class="s">'Dep_Time'</span><span class="p">]</span><span class="o">=</span><span class="n">X_train</span><span class="p">[</span><span class="s">'Dep_Time'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">hour_cal</span><span class="p">)</span>
<span class="n">X_test</span><span class="p">[</span><span class="s">'Dep_Time'</span><span class="p">]</span><span class="o">=</span><span class="n">X_test</span><span class="p">[</span><span class="s">'Dep_Time'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">hour_cal</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">[</span><span class="s">'Arrival_Time'</span><span class="p">]</span><span class="o">=</span><span class="n">X_train</span><span class="p">[</span><span class="s">'Arrival_Time'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">hour_cal</span><span class="p">)</span>
<span class="n">X_test</span><span class="p">[</span><span class="s">'Arrival_Time'</span><span class="p">]</span><span class="o">=</span><span class="n">X_test</span><span class="p">[</span><span class="s">'Arrival_Time'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">hour_cal</span><span class="p">)</span>

<span class="c1"># ì†Œìš”ì‹œê°„ ê³„ì‚°
</span><span class="k">def</span> <span class="nf">hour_cal2</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">hour</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s">'(\d+)h'</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">hour</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">minute</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s">'(\d+)m'</span><span class="p">,</span> <span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">minute</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">hour</span><span class="o">*</span><span class="mi">60</span><span class="o">+</span><span class="n">minute</span>
<span class="n">X_train</span><span class="p">[</span><span class="s">'Duration'</span><span class="p">]</span><span class="o">=</span><span class="n">X_train</span><span class="p">[</span><span class="s">'Duration'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">hour_cal2</span><span class="p">)</span>
<span class="n">X_test</span><span class="p">[</span><span class="s">'Duration'</span><span class="p">]</span><span class="o">=</span><span class="n">X_test</span><span class="p">[</span><span class="s">'Duration'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">hour_cal2</span><span class="p">)</span>

<span class="c1"># stopì—ì„œ ìˆ«ìë§Œ ë‚¨ê¸°ì
</span><span class="n">X_train</span><span class="p">[</span><span class="s">'Total_Stops'</span><span class="p">]</span><span class="o">=</span><span class="n">X_train</span><span class="p">[</span><span class="s">'Total_Stops'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s">'n'</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">X_test</span><span class="p">[</span><span class="s">'Total_Stops'</span><span class="p">]</span><span class="o">=</span><span class="n">X_train</span><span class="p">[</span><span class="s">'Total_Stops'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s">'n'</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="n">info</span><span class="p">())</span>

<span class="n">X_train</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 10683 entries, 0 to 10682
Data columns (total 8 columns):
 #   Column           Non-Null Count  Dtype
---  ------           --------------  -----
 0   Airline          10683 non-null  object
 1   Source           10683 non-null  object
 2   Destination      10683 non-null  object
 3   Dep_Time         10683 non-null  int64
 4   Arrival_Time     10683 non-null  int64
 5   Duration         10683 non-null  int64
 6   Total_Stops      10683 non-null  int64
 7   Additional_Info  10683 non-null  object
dtypes: int64(4), object(4)
memory usage: 667.8+ KB
None
</code></pre></div></div>

<div id="df-5e346ee7-84fc-40d0-874c-f1a960b92b39">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Airline</th>
      <th>Source</th>
      <th>Destination</th>
      <th>Dep_Time</th>
      <th>Arrival_Time</th>
      <th>Duration</th>
      <th>Total_Stops</th>
      <th>Additional_Info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>IndiGo</td>
      <td>Banglore</td>
      <td>New Delhi</td>
      <td>1340</td>
      <td>70</td>
      <td>170</td>
      <td>0</td>
      <td>No info</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Air India</td>
      <td>Kolkata</td>
      <td>Banglore</td>
      <td>350</td>
      <td>795</td>
      <td>445</td>
      <td>2</td>
      <td>No info</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jet Airways</td>
      <td>Delhi</td>
      <td>Cochin</td>
      <td>565</td>
      <td>265</td>
      <td>1140</td>
      <td>2</td>
      <td>No info</td>
    </tr>
    <tr>
      <th>3</th>
      <td>IndiGo</td>
      <td>Kolkata</td>
      <td>Banglore</td>
      <td>1085</td>
      <td>1410</td>
      <td>325</td>
      <td>1</td>
      <td>No info</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IndiGo</td>
      <td>Banglore</td>
      <td>New Delhi</td>
      <td>1010</td>
      <td>1295</td>
      <td>285</td>
      <td>1</td>
      <td>No info</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5e346ee7-84fc-40d0-874c-f1a960b92b39')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5e346ee7-84fc-40d0-874c-f1a960b92b39 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5e346ee7-84fc-40d0-874c-f1a960b92b39');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_train</span> <span class="o">=</span> <span class="n">X_train</span>
<span class="n">df_train</span><span class="p">[</span><span class="s">'price'</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span>
<span class="n">df_train</span><span class="p">.</span><span class="n">profile_report</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Output hidden; open in https://colab.research.google.com to view.
</code></pre></div></div>

<h1 id="ì¸ì½”ë”©-one-hot-encoding-ì‚¬ìš©">ì¸ì½”ë”© (one hot encoding ì‚¬ìš©)</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì›í•« ì¸ì½”ë”©
</span>
<span class="c1">#X_train=pd.get_dummies(data = X_train, columns = ['Airline', 'Source', 'Destination', 'Total_Stops',  'Additional_Info'])
#X_test=pd.get_dummies(data = X_test, columns = ['Airline', 'Source', 'Destination', 'Total_Stops',  'Additional_Info'])
</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">])</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Airline'</span><span class="p">,</span> <span class="s">'Source'</span><span class="p">,</span> <span class="s">'Destination'</span><span class="p">,</span> <span class="s">'Total_Stops'</span><span class="p">,</span>  <span class="s">'Additional_Info'</span><span class="p">])</span>
<span class="n">X_train_encoded</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)]</span>
<span class="n">X_test_encoded</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">):]</span>

<span class="k">print</span><span class="p">(</span><span class="n">X_train_encoded</span><span class="p">.</span><span class="n">info</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">X_test_encoded</span><span class="p">.</span><span class="n">info</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 10683 entries, 0 to 10682
Data columns (total 42 columns):
 #   Column                                        Non-Null Count  Dtype  
---  ------                                        --------------  -----  
 0   Dep_Time                                      10683 non-null  int64  
 1   Arrival_Time                                  10683 non-null  int64  
 2   Duration                                      10683 non-null  int64  
 3   price                                         10683 non-null  float64
 4   Airline_Air Asia                              10683 non-null  uint8  
 5   Airline_Air India                             10683 non-null  uint8  
 6   Airline_GoAir                                 10683 non-null  uint8  
 7   Airline_IndiGo                                10683 non-null  uint8  
 8   Airline_Jet Airways                           10683 non-null  uint8  
 9   Airline_Jet Airways Business                  10683 non-null  uint8  
 10  Airline_Multiple carriers                     10683 non-null  uint8  
 11  Airline_Multiple carriers Premium economy     10683 non-null  uint8  
 12  Airline_SpiceJet                              10683 non-null  uint8  
 13  Airline_Trujet                                10683 non-null  uint8  
 14  Airline_Vistara                               10683 non-null  uint8  
 15  Airline_Vistara Premium economy               10683 non-null  uint8  
 16  Source_Banglore                               10683 non-null  uint8  
 17  Source_Chennai                                10683 non-null  uint8  
 18  Source_Delhi                                  10683 non-null  uint8  
 19  Source_Kolkata                                10683 non-null  uint8  
 20  Source_Mumbai                                 10683 non-null  uint8  
 21  Destination_Banglore                          10683 non-null  uint8  
 22  Destination_Cochin                            10683 non-null  uint8  
 23  Destination_Delhi                             10683 non-null  uint8  
 24  Destination_Hyderabad                         10683 non-null  uint8  
 25  Destination_Kolkata                           10683 non-null  uint8  
 26  Destination_New Delhi                         10683 non-null  uint8  
 27  Total_Stops_0                                 10683 non-null  uint8  
 28  Total_Stops_1                                 10683 non-null  uint8  
 29  Total_Stops_2                                 10683 non-null  uint8  
 30  Total_Stops_3                                 10683 non-null  uint8  
 31  Total_Stops_4                                 10683 non-null  uint8  
 32  Additional_Info_1 Long layover                10683 non-null  uint8  
 33  Additional_Info_1 Short layover               10683 non-null  uint8  
 34  Additional_Info_2 Long layover                10683 non-null  uint8  
 35  Additional_Info_Business class                10683 non-null  uint8  
 36  Additional_Info_Change airports               10683 non-null  uint8  
 37  Additional_Info_In-flight meal not included   10683 non-null  uint8  
 38  Additional_Info_No Info                       10683 non-null  uint8  
 39  Additional_Info_No check-in baggage included  10683 non-null  uint8  
 40  Additional_Info_No info                       10683 non-null  uint8  
 41  Additional_Info_Red-eye flight                10683 non-null  uint8  
dtypes: float64(1), int64(3), uint8(38)
memory usage: 813.7 KB
None
&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 2671 entries, 0 to 2670
Data columns (total 42 columns):
 #   Column                                        Non-Null Count  Dtype  
---  ------                                        --------------  -----  
 0   Dep_Time                                      2671 non-null   int64  
 1   Arrival_Time                                  2671 non-null   int64  
 2   Duration                                      2671 non-null   int64  
 3   price                                         0 non-null      float64
 4   Airline_Air Asia                              2671 non-null   uint8  
 5   Airline_Air India                             2671 non-null   uint8  
 6   Airline_GoAir                                 2671 non-null   uint8  
 7   Airline_IndiGo                                2671 non-null   uint8  
 8   Airline_Jet Airways                           2671 non-null   uint8  
 9   Airline_Jet Airways Business                  2671 non-null   uint8  
 10  Airline_Multiple carriers                     2671 non-null   uint8  
 11  Airline_Multiple carriers Premium economy     2671 non-null   uint8  
 12  Airline_SpiceJet                              2671 non-null   uint8  
 13  Airline_Trujet                                2671 non-null   uint8  
 14  Airline_Vistara                               2671 non-null   uint8  
 15  Airline_Vistara Premium economy               2671 non-null   uint8  
 16  Source_Banglore                               2671 non-null   uint8  
 17  Source_Chennai                                2671 non-null   uint8  
 18  Source_Delhi                                  2671 non-null   uint8  
 19  Source_Kolkata                                2671 non-null   uint8  
 20  Source_Mumbai                                 2671 non-null   uint8  
 21  Destination_Banglore                          2671 non-null   uint8  
 22  Destination_Cochin                            2671 non-null   uint8  
 23  Destination_Delhi                             2671 non-null   uint8  
 24  Destination_Hyderabad                         2671 non-null   uint8  
 25  Destination_Kolkata                           2671 non-null   uint8  
 26  Destination_New Delhi                         2671 non-null   uint8  
 27  Total_Stops_0                                 2671 non-null   uint8  
 28  Total_Stops_1                                 2671 non-null   uint8  
 29  Total_Stops_2                                 2671 non-null   uint8  
 30  Total_Stops_3                                 2671 non-null   uint8  
 31  Total_Stops_4                                 2671 non-null   uint8  
 32  Additional_Info_1 Long layover                2671 non-null   uint8  
 33  Additional_Info_1 Short layover               2671 non-null   uint8  
 34  Additional_Info_2 Long layover                2671 non-null   uint8  
 35  Additional_Info_Business class                2671 non-null   uint8  
 36  Additional_Info_Change airports               2671 non-null   uint8  
 37  Additional_Info_In-flight meal not included   2671 non-null   uint8  
 38  Additional_Info_No Info                       2671 non-null   uint8  
 39  Additional_Info_No check-in baggage included  2671 non-null   uint8  
 40  Additional_Info_No info                       2671 non-null   uint8  
 41  Additional_Info_Red-eye flight                2671 non-null   uint8  
dtypes: float64(1), int64(3), uint8(38)
memory usage: 203.5 KB
None
</code></pre></div></div>

<h1 id="íŠ¹ì„±-ì„ íƒ-selectkbestì‚¬ìš©">íŠ¹ì„± ì„ íƒ (SelectKBestì‚¬ìš©)</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">SelectKBest</span>
<span class="n">selector1</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">chi2</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">X_train1</span> <span class="o">=</span> <span class="n">selector1</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_encoded</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">X_train_encoded</span><span class="p">.</span><span class="n">columns</span>
<span class="n">X_train_encoded</span> <span class="o">=</span> <span class="n">X_train_encoded</span><span class="p">[</span><span class="n">columns</span><span class="p">[</span><span class="n">selector1</span><span class="p">.</span><span class="n">get_support</span><span class="p">()]]</span>
<span class="n">X_test_encoded</span> <span class="o">=</span> <span class="n">X_test_encoded</span><span class="p">[</span><span class="n">columns</span><span class="p">[</span><span class="n">selector1</span><span class="p">.</span><span class="n">get_support</span><span class="p">()]]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------

ValueError                                Traceback (most recent call last)

&lt;ipython-input-33-6ef92159fc82&gt; in &lt;module&gt;()
      1 from sklearn.feature_selection import chi2, SelectKBest
      2 selector1 = SelectKBest(chi2, k=5)
----&gt; 3 X_train1 = selector1.fit_transform(X_train_encoded, y_train)
      4 columns = X_train_encoded.columns
      5 X_train_encoded = X_train_encoded[columns[selector1.get_support()]]


/usr/local/lib/python3.7/dist-packages/sklearn/base.py in fit_transform(self, X, y, **fit_params)
    853         else:
    854             # fit method of arity 2 (supervised transformation)
--&gt; 855             return self.fit(X, y, **fit_params).transform(X)
    856
    857


/usr/local/lib/python3.7/dist-packages/sklearn/feature_selection/_univariate_selection.py in fit(self, X, y)
    405             )
    406
--&gt; 407         self._check_params(X, y)
    408         score_func_ret = self.score_func(X, y)
    409         if isinstance(score_func_ret, (list, tuple)):


/usr/local/lib/python3.7/dist-packages/sklearn/feature_selection/_univariate_selection.py in _check_params(self, X, y)
    604             raise ValueError(
    605                 "k should be &gt;=0, &lt;= n_features = %d; got %r. "
--&gt; 606                 "Use k='all' to return all features." % (X.shape[1], self.k)
    607             )
    608


ValueError: k should be &gt;=0, &lt;= n_features = 4; got 5. Use k='all' to return all features.
</code></pre></div></div>

<h1 id="ìŠ¤ì¼€ì¼ë§-ë°-ëª¨ë¸-êµ¬ì„±-fit">ìŠ¤ì¼€ì¼ë§ ë° ëª¨ë¸ êµ¬ì„±, fit</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="c1"># StandardScaler
</span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_encoded</span><span class="p">)</span>
<span class="n">X_train_scaled</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">X_train_scaled</span><span class="p">)</span>

<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test_encoded</span><span class="p">)</span>
<span class="n">X_test_scaled</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">X_test_scaled</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># modeling MLP
</span><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span><span class="p">,</span> <span class="n">SGD</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">regularizers</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'tanh'</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">,</span>
                <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">regularizers</span><span class="p">.</span><span class="n">l1</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>   
                <span class="n">activity_regularizer</span><span class="o">=</span><span class="n">regularizers</span><span class="p">.</span><span class="n">l2</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
         <span class="p">)</span>
<span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">))</span>
<span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'linear'</span><span class="p">))</span>

<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'Adam'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s">'mse'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'mae'</span><span class="p">])</span>

<span class="c1"># model fit
</span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">256</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="loss-ë³€ë™-ê·¸ë˜í”„ë¡œ-í™•ì¸">loss ë³€ë™ ê·¸ë˜í”„ë¡œ í™•ì¸</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">val_loss</span> <span class="o">=</span> <span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'val_loss'</span><span class="p">]</span>
<span class="n">val_mae</span> <span class="o">=</span> <span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'val_mae'</span><span class="p">]</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_loss</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">val_loss</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'val loss'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/project/source_1.png" width="90%" height="90%" /></p>

<blockquote>
  <p>..? ë„ˆë¬´ ëª¨ì–‘ ì™„ë²½í•œ ê·¸ë˜í”„ë¥¼ ê°–ëŠ”ë‹¤.. ì™œì§€</p>
</blockquote>

<h1 id="ì–´ë–¤-ì˜ˆì¸¡ê°’ì„-ê°–ì§€">ì–´ë–¤ ì˜ˆì¸¡ê°’ì„ ê°–ì§€â€¦?</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_encoded</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[9079.562],
       [9079.562],
       [9079.562],
       [9079.562],
       [9079.562],
       [9079.562],
       [9079.562],
       [9079.562],
       [9079.562],
       [9079.562]], dtype=float32)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># maeê°€ ìµœì†Œë¡œí•˜ëŠ” í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ìˆ˜ë ´í•´ë²„ë¦¼..
# ë”¥ëŸ¬ë‹ê¹Œì§€ í•„ìš”ì—†ëŠ” ë°ì´í„°ì— ë”¥ëŸ¬ë‹ì„ ì¨ë²„ë¦¬ë©´..
# ë³µì¡ë„ë§Œ ì˜¬ë¼ê°€ê³  ì„±ëŠ¥ì€ ë‚˜ì˜¤ì§€ ì•ŠëŠ” ê²ƒ ê°™ë‹¤.
</span></code></pre></div></div>

<h1 id="ì†Œì¡ëŠ”ì¹¼">ì†Œì¡ëŠ”ì¹¼â€¦!</h1>

<p><br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš°
ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„
</code></pre></div></div>

<p><a href="#" class="btn btn--primary align-right">ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°</a></p>]]></content><author><name>ì˜¹ë‹¬ìƒ˜ğŸ‘±ğŸ¼â€â™‚ï¸</name></author><category term="pj" /><category term="MLP" /><summary type="html"><![CDATA[íŒë‹¤ìŠ¤ í”„ë¡œíŒŒì¼ë§ ì½”ë©ì—ì„œ ì‘ë™í•˜ë„ë¡ ë²„ì „ì§€ì • ì„¤ì¹˜]]></summary></entry><entry><title type="html">ë„ì»¤(docker)ë¡œ ë¦¬ëˆ…ìŠ¤í™˜ê²½ì„ ë§Œë“¤ê³  pyíŒŒì¼ì„ ì‹¤í–‰í•´ë³´ì.</title><link href="http://localhost:4000/de/docker/" rel="alternate" type="text/html" title="ë„ì»¤(docker)ë¡œ ë¦¬ëˆ…ìŠ¤í™˜ê²½ì„ ë§Œë“¤ê³  pyíŒŒì¼ì„ ì‹¤í–‰í•´ë³´ì." /><published>2022-03-25T00:00:00+09:00</published><updated>2022-03-25T00:00:00+09:00</updated><id>http://localhost:4000/de/docker</id><content type="html" xml:base="http://localhost:4000/de/docker/"><![CDATA[<h2 id="ë„ì»¤ê°€-ë­">ë„ì»¤ê°€ ë­?</h2>
<p>ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•˜ê²Œ í•´ì£¼ëŠ” í”Œë«í¼ì´ë©°, ì´ ì»¨í…Œì´ë„ˆëŠ” VM(Virtual Machine) ê³¼ ê°€ì¥ ë¹„êµë¥¼ ë§ì´í•œë‹¤.<br />
OS ë¨¼ì € ì •í™•íˆ ë§í•˜ë©´, ì»´í“¨í„°ë¥¼ ì‚¬ìš©ìê°€ í¸í•˜ê²Œ ì“¸ ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ì´ë©°, ì•ˆë“œë¡œì´ë“œ, iOS, ìœˆë„ìš°, macOS ë“±ì´ ìˆë‹¤.<br />
VMì€ ì‚¬ìš©ì OSì˜ ê°ì¢… ì†ŒìŠ¤ë“¤ì„ ê°ê° ì „ìš©ìœ¼ë¡œ í• ë‹¹í•˜ì—¬ ê°€ìƒOSë¥¼ ë§Œë“œëŠ” ë°©ì‹ì´ë¼ë©´,<br />
ì»¨í…Œì´ë„ˆëŠ” dockerë¼ëŠ” íˆ´ì„ ì´ìš©í•˜ì—¬, ê·¸ ìœ„ì—ì„œ ì´ë¯¸ì§€(ì–´í”Œë¦¬ì¼€ì´ì…˜)ì„ ì‹¤í–‰í•˜ëŠ” ë°©ì‹ì´ë‹¤. (ì†ŒìŠ¤ë¥¼ í• ë‹¹í•˜ëŠ” ê°œë…ì´ì•„ë‹˜, ê°ê° ì œí•œì€ í•  ìˆ˜ ìˆìŒ)</p>

<blockquote>
  <p>ëª©ì <br />
ë‹¤ë¥¸ OSì—ì„œë„ ì‘ë™í•˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ ì´ë¯¸ì§€ë¡œ ë§Œë“¤ê³  ë°°í¬í•˜ê²Œ í•œë‹¤.</p>
</blockquote>

<blockquote>
  <p>ì¥ì <br />
VMë³´ë‹¤ ê°€ë³ê³  ë¹ ë¥´ë‹¤.<br />
ë°°í¬ê°€ ìš©ì´í•˜ë‹¤.<br />
ì ì€ ìš©ëŸ‰ì˜ ì´ë¯¸ì§€ë¡œ ê´€ë¦¬ ê°€ëŠ¥í•˜ë‹¤.</p>
</blockquote>

<h2 id="ë„ì»¤íŒŒì¼dockerfile">ë„ì»¤íŒŒì¼(Dockerfile)</h2>
<p>ê°ê° ë…ë¦½ìœ¼ë¡œ ì‘ë™í•˜ëŠ” íŒŒì¼ì„ ì´ë¯¸ì§€(image)ë¼ê³  í•˜ëŠ”ë°, ì´ ì´ë¯¸ì§€ë¥¼ ì–´ë–»ê²Œ ë¹Œë“œí•  ê²ƒì¸ì§€ ì ì–´ë†“ëŠ” ë¬¸ì„œ. (ì´ë¦„ì´ ë¬´ì¡°ê±´ Dockerfile)</p>
<blockquote>
  <blockquote>
    <p>ê°„ë‹¨ ëª…ë ¹ì–´ <br />
FROM : ë² ì´ìŠ¤ ì´ë¯¸ì§€<br />
RUN : ì»¨í…Œì´ë„ˆ ìƒì„± ì „ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•œë‹¤.<br />
COPY a b: a íŒŒì¼ì„ í•¨ê»˜ ì»¨í…Œì´ë„ˆ bê²½ë¡œì— ì´ë¯¸ì§€ë¡œ ë¹Œë“œí•œë‹¤.  (..ì€ dockerfileê³¼ ê°™ì€ê²½ë¡œë‚´ ì „ë¶€)<br />
ENV : í™˜ê²½ë³€ìˆ˜ ì„¤ì •
ENTRYPOINT : ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ë©´ì„œ ìˆ˜í–‰í•˜ëŠ” ëª…ë ¹<br />
CMD : ENTRYPOINTì²˜ëŸ¼ ì‹¤í–‰í•˜ë©´ì„œ ìˆ˜í–‰í•˜ëŠ” ëª…ë ¹ì¸ë° docker run ìˆ˜í–‰ì‹œ(ì´ë¯¸ì§€ ì‹¤í–‰) ì¸ìê°’ì„ ì¶”ê°€í•´ì„œ ë‹¤ë¥¸ê°’ì„ ë„£ì„ ìˆ˜ ìˆë‹¤.<br />
WORKDIR : ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •</p>
  </blockquote>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FROM ubuntu:18.04

RUN apt update -y
RUN apt install python3.6 -y
RUN apt install python3-pip -y

RUN apt update -y

# requirements ìˆìœ¼ë©´ ì•„ë˜êº¼ ì‹¤í–‰
# COPY ./ubuntu1804/requirements.txt /requirements.txt
# RUN pip3 install -r /requirements.txt
# RUN apt update -y
# ê°™ì€ í´ë”ë‚´ íŒŒì¼ ë³µì‚¬
COPY . .

# test.py íŒŒì´ì¬ìœ¼ë¡œ ì‹¤í–‰

RUN apt update -y


# ê°ì¢… í•œê¸€ í°íŠ¸ ì„¤ì¹˜
RUN apt install language-pack-ko -y
RUN apt install fonts-nanum -y
RUN apt install fonts-nanum-coding -y
RUN apt install fonts-noto-cjk -y

# í™˜ê²½ë³€ìˆ˜ ì§€ì •
ENV LANG ko_KR.UTF-8
ENV LANGUAGE ko_KR.UTF-8
ENV LC_ALL ko_KR.UTF-8

# ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•  ë•Œ ìˆ˜í–‰í•˜ëŠ” ëª…ë ¹ì–´
CMD ["test.py"]

ENTRYPOINT ["python3"]
WORKDIR /root
RUN echo 'alias python=python3.6' &gt;&gt; .bashrc

WORKDIR /
</code></pre></div></div>

<blockquote>
  <p>ìœ„ ë‚´ìš©ì˜ Dockerfile ë¬¸ì„œì™€ í•¨ê»˜ ìˆëŠ” test.pyê°€ ì‹¤í–‰ë¨ê³¼ ë™ì‹œì— ë¦¬ëˆ…ìŠ¤ í™˜ê²½ ì»¨í…Œì´ë„ˆê°€ ìƒì„±ëœë‹¤.</p>
</blockquote>

<p><br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš°
ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„
</code></pre></div></div>

<p><a href="#" class="btn btn--primary align-right">ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°</a></p>]]></content><author><name>ì˜¹ë‹¬ìƒ˜ğŸ‘±ğŸ¼â€â™‚ï¸</name></author><category term="de" /><summary type="html"><![CDATA[ë„ì»¤ê°€ ë­? ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•˜ê²Œ í•´ì£¼ëŠ” í”Œë«í¼ì´ë©°, ì´ ì»¨í…Œì´ë„ˆëŠ” VM(Virtual Machine) ê³¼ ê°€ì¥ ë¹„êµë¥¼ ë§ì´í•œë‹¤. OS ë¨¼ì € ì •í™•íˆ ë§í•˜ë©´, ì»´í“¨í„°ë¥¼ ì‚¬ìš©ìê°€ í¸í•˜ê²Œ ì“¸ ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ì´ë©°, ì•ˆë“œë¡œì´ë“œ, iOS, ìœˆë„ìš°, macOS ë“±ì´ ìˆë‹¤. VMì€ ì‚¬ìš©ì OSì˜ ê°ì¢… ì†ŒìŠ¤ë“¤ì„ ê°ê° ì „ìš©ìœ¼ë¡œ í• ë‹¹í•˜ì—¬ ê°€ìƒOSë¥¼ ë§Œë“œëŠ” ë°©ì‹ì´ë¼ë©´, ì»¨í…Œì´ë„ˆëŠ” dockerë¼ëŠ” íˆ´ì„ ì´ìš©í•˜ì—¬, ê·¸ ìœ„ì—ì„œ ì´ë¯¸ì§€(ì–´í”Œë¦¬ì¼€ì´ì…˜)ì„ ì‹¤í–‰í•˜ëŠ” ë°©ì‹ì´ë‹¤. (ì†ŒìŠ¤ë¥¼ í• ë‹¹í•˜ëŠ” ê°œë…ì´ì•„ë‹˜, ê°ê° ì œí•œì€ í•  ìˆ˜ ìˆìŒ)]]></summary></entry><entry><title type="html">CNN êµ¬ì¡° ì´í•´</title><link href="http://localhost:4000/ds/CNN/" rel="alternate" type="text/html" title="CNN êµ¬ì¡° ì´í•´" /><published>2022-03-19T00:00:00+09:00</published><updated>2020-03-19T00:00:00+09:00</updated><id>http://localhost:4000/ds/CNN</id><content type="html" xml:base="http://localhost:4000/ds/CNN/"><![CDATA[<h2 id="cnn-ì˜-ëª©ì ">CNN ì˜ ëª©ì </h2>
<p>ì»´í“¨í„°ì— ì´ë¯¸ì§€ë¥¼ ì´í•´ì‹œí‚¤ëŠ” ë°©ë²•ì„ ìƒê°í•´ë³´ì.<br />
ì´ë¯¸ì§€ëŠ” RGB, BGRì˜ 3ìë¦¬ ìˆ«ìê°€ ëª¨ë“  ì ë“¤ì„ êµ¬ì„±í•œë‹¤.<br />
ê·¸ë ‡ë‹¤ë©´ ê°•ì•„ì§€ ì‚¬ì§„ 1ì˜ ëª¨ë“  RGB ìˆ«ìë“¤ì„ ê·¸ëŒ€ë¡œ ì»´í“¨í„°ì—ê²Œ ì•Œë ¤ì¤€ë‹¤ë©´,<br />
ì»´í“¨í„°ëŠ” êµ¬ë„ë§Œ ì‚´ì§ ë°”ë€ ê°•ì•„ì§€ ì‚¬ì§„ 2ëŠ” ì „í˜€ ë‹¤ë¥¸ ì‚¬ì§„ì´ë¼ê³  ìƒê°í•  ê²ƒì´ë‹¤.</p>

<p>ì´ë¥¼ ìœ„í•´ CNNì—ì„œëŠ” â€˜í•„í„°â€™ë¼ëŠ” ê°œë…ì„ ì´ìš©í•˜ì—¬ â€˜íŠ¹ì§•â€™ì„ ì¶”ì¶œí•œë‹¤.</p>

<h2 id="ì´ê²ƒë§Œ-ì´í•´í•˜ì-no1">ì´ê²ƒë§Œ ì´í•´í•˜ì. No.1</h2>
<p><img src="/assets/images/ds/source_0.png" width="60%" height="60%" /><br />
í•„í„°ëŠ” ìœ„ì™€ê°™ì´ ì ìš©ëœë‹¤. í•„í„° í•˜ë‚˜í•˜ë‚˜ê°€ ê°€ì¤‘ì¹˜ì˜ ì—­í• ì„ í•˜ë©°, í•„í„°ì˜ ëª¨ì–‘ì— ë”°ë¼ ì´ë¯¸ì§€ì˜ ì–´ë–¤ íŠ¹ì§•ë“¤ì„ ì¶”ì¶œí•˜ëŠ”ì§€ ê²°ì •ëœë‹¤.</p>

<h2 id="ì´ê²ƒë§Œ-ì´í•´í•˜ì-no2">ì´ê²ƒë§Œ ì´í•´í•˜ì. No.2</h2>
<p><img src="/assets/images/ds/source_1.png" width="60%" height="60%" /><br />
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-<br />
CNNì˜ Layerë¥¼ í•˜ë‚˜ì”© ìŒ“ê³  ìˆë‹¤.<br />
ì²«ë²ˆì§¸ Conv2D ì½”ë“œë¥¼ ë³´ì,  (32,32) ì‚¬ì´ì¦ˆì˜ 3ê²¹(rgb, bgr) ì´ë¯¸ì§€ë¥¼ 3by3 í•„í„° ê°€ì¤‘ì¹˜ë¥¼ ì´ìš©í•˜ì—¬ 32ê°œì˜ feature mapì„ ë§Œë“¤ê² ë‹¤ê³  ë˜ì–´ìˆë‹¤.<br />
ê·¸ ê²°ê³¼, (30,30) ì‚¬ì´ì¦ˆì˜ 32ê²¹ í”¼ì³ë§µì„ ë§Œë“¤ì—ˆê³ , paramìˆ˜ëŠ” 896ê°œì´ë‹¤.<br />
ê°€ì¤‘ì¹˜ì˜ ê°¯ìˆ˜ëŠ” ì‹ ê²½ë§ì˜ ì›ë¦¬ì—ì„œ ê° ê°€ì¤‘ì¹˜ë¥¼ í•„í„°ë¡œ ê°–ëŠ”ë‹¤ê³  ìƒê°í•˜ë©´ ì‰½ë‹¤.<br />
3 (=input) x 32(=output) x 9(=3*3í•„í„°) + 32(í¼ì…‰íŠ¸ë¡  ì‹ ê²½ë§ nodeì™€ ê°™ì´ ê° featureë§µ ê°€ì¤‘ì¹˜)<br />
=896</p>

<h2 id="ì´ê²ƒë§Œ-ì´í•´í•˜ì-no3">ì´ê²ƒë§Œ ì´í•´í•˜ì. No.3</h2>
<p><img src="/assets/images/ds/source_2.png" width="40%" height="40%" /><br />
No.2ì˜ ì˜ˆì‹œì—ì„œ (32,32)ê°€ (30,30)ìœ¼ë¡œ ë˜ëŠ” ê±´ 3*3í•„í„°ë¥¼ ëŒ€ì…í•´ë³´ë©´ ì–¼ì¶” ë°”ë¡œ ì•Œ ìˆ˜ ìˆëŠ”ë°,<br />
strideë‚˜ paddingì´ ë“¤ì–´ê°€ë©´ í—·ê°ˆë¦´ ìˆ˜ ìˆë‹¤. ìœ„ ì‹ì— ëŒ€ì…í•´ì„œ ì •í™•íˆ êµ¬í•  ìˆ˜ ìˆë‹¤.</p>

<h2 id="í‚¤ì›Œë“œ-ì •ë¦¬">í‚¤ì›Œë“œ ì •ë¦¬</h2>
<ol>
  <li>í•„í„° (kernel, filter)</li>
  <li>í”¼ì³ë§µ (feature map)</li>
  <li>íŒ¨ë”© (padding, zero padding) : ê°€ì¥ìë¦¬ì—ì„œ í•„í„°ë•Œë¬¸ì— ì†Œì‹¤ë˜ëŠ” ë°ì´í„°ë¥¼ ë§‰ê¸° ìœ„í•´ ì‚¬ìš©, ì´ë¯¸ì§€ë¥¼ í•œë²ˆ 0ìœ¼ë¡œ ê°ì‹¸ëŠ” ê²ƒ.
    <ul>
      <li>ì‚¬ì´ì¦ˆì— ë”°ë¼ ë¶„ë¥˜ : valid padding(íŒ¨ë”©ì•ˆí•¨),<br />
 full padding (í•„í„°ì‚¬ì´ì¦ˆ-1 ë§Œí¼ë‘ê»˜ë¡œ ëª¨ë‘ ê°ì‹¸ëŠ” ê²ƒ, edgeì˜ ë°ì´í„° ì†ì‹¤ì„ ë§‰ëŠ”ë‹¤ëŠ” ì˜ì˜ë¥¼ ê°€ì§„ë‹¤),<br />
 same padding(inputì´ë¯¸ì§€ì™€ outputì´ë¯¸ì§€ ì‚¬ì´ì¦ˆê°€ ê°™ë„ë¡ íŒ¨ë”©, ì‚¬ì´ì¦ˆê°€ ì ì  ì‘ì•„ì§€ëŠ” í˜„ìƒì„ ë§‰ëŠ” ë‹¤ëŠ” ì˜ë¯¸ê°€ ìˆìŒ.)</li>
    </ul>
  </li>
  <li>ìŠ¤íŠ¸ë¼ì´ë“œ (stride) : ì»¤ë„ì„ ëŒ€ì…í•  ë•Œ, ì´ë™í•˜ëŠ” ì¹¸ ìˆ˜ë¥¼ ë§í•œë‹¤. (1ì´ë©´ í•œì¹¸ì”© ì´ë™)</li>
  <li>í’€ë§(pulling) :  ì´ë¯¸ì§€, í”¼ì³ë§µì˜ ì‚¬ì´ì¦ˆë¥¼ ì¤„ì„. ë‚´ë¶€ì˜ ì •ë³´ ë“±ì„ ì¤„ì´ê¸° ë•Œë¬¸ì— ì˜¤ë²„í”¼íŒ… íš¨ê³¼ ë° ë©”ëª¨ë¦¬ ì ˆì•½</li>
</ol>

<p><br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš°
ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„
</code></pre></div></div>

<p><a href="#" class="btn btn--primary align-right">ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°</a></p>]]></content><author><name>ì˜¹ë‹¬ìƒ˜ğŸ‘±ğŸ¼â€â™‚ï¸</name></author><category term="ds" /><summary type="html"><![CDATA[CNN ì˜ ëª©ì  ì»´í“¨í„°ì— ì´ë¯¸ì§€ë¥¼ ì´í•´ì‹œí‚¤ëŠ” ë°©ë²•ì„ ìƒê°í•´ë³´ì. ì´ë¯¸ì§€ëŠ” RGB, BGRì˜ 3ìë¦¬ ìˆ«ìê°€ ëª¨ë“  ì ë“¤ì„ êµ¬ì„±í•œë‹¤. ê·¸ë ‡ë‹¤ë©´ ê°•ì•„ì§€ ì‚¬ì§„ 1ì˜ ëª¨ë“  RGB ìˆ«ìë“¤ì„ ê·¸ëŒ€ë¡œ ì»´í“¨í„°ì—ê²Œ ì•Œë ¤ì¤€ë‹¤ë©´, ì»´í“¨í„°ëŠ” êµ¬ë„ë§Œ ì‚´ì§ ë°”ë€ ê°•ì•„ì§€ ì‚¬ì§„ 2ëŠ” ì „í˜€ ë‹¤ë¥¸ ì‚¬ì§„ì´ë¼ê³  ìƒê°í•  ê²ƒì´ë‹¤.]]></summary></entry><entry><title type="html">ì‚¬ëŒì–¼êµ´ì— ìŠ¤íƒ€ì¼ ë°”ê¿”ë³´ê¸°</title><link href="http://localhost:4000/pj/stylegan/" rel="alternate" type="text/html" title="ì‚¬ëŒì–¼êµ´ì— ìŠ¤íƒ€ì¼ ë°”ê¿”ë³´ê¸°" /><published>2022-03-10T00:00:00+09:00</published><updated>2022-03-13T00:00:00+09:00</updated><id>http://localhost:4000/pj/stylegan</id><content type="html" xml:base="http://localhost:4000/pj/stylegan/"><![CDATA[<h2 id="ëª©í‘œ">ëª©í‘œ</h2>
<p>ì„ì˜ì˜ ì´ˆìƒê¶Œ ì—†ëŠ” ì–¼êµ´ì„ íŠ¹ì • ìŠ¤íƒ€ì¼ì„ ì…í˜€ ë§Œë“¤ê¸°.</p>

<h2 id="ë°©ë²•">ë°©ë²•</h2>
<p>ì„ì‹œë¡œ ìƒì„±í•œ ì‚¬ëŒì–¼êµ´(ì‹¤ì¡´x) ì´ë¯¸ì§€ì— ì›í•˜ëŠ” íŠ¹ì • ìŠ¤íƒ€ì¼ì„ ê°€ì§„ ì‚¬ëŒ(ì‹¤ì¡´o)ì˜ ì´ë¯¸ì§€ë¥¼ ì ìš©í•˜ì—¬ ìƒˆë¡­ê²Œ ìƒì„±.</p>

<ol>
  <li>styleGAN2-ada ëª¨ë¸ì˜ ffhq preTrained ê°€ì¤‘ì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì–¼êµ´ìƒì„±.</li>
  <li>ì›í•˜ëŠ” ìŠ¤íƒ€ì¼ì˜ ì‚¬ëŒì‚¬ì§„ì˜ ìŠ¤íƒ€ì¼ ë²¡í„°ë“¤ì„ ì¶”ì¶œ (PSP ëª¨ë¸ì˜ ì¼ë¶€ ì‚¬ìš©)</li>
  <li>1ë²ˆì—ì„œ ìƒì„±í•œ ì´ë¯¸ì§€ë¥¼ inversioní•˜ì—¬ ë‹¤ì‹œ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ëŠ” ê³¼ì •ì—ì„œ 2ë²ˆì˜ ìŠ¤íƒ€ì¼ ë²¡í„°ë“¤ì„ injectí•˜ì—¬ ìµœì¢… ìƒì„±.</li>
</ol>

<p><img src="/assets/images/source_26.png" width="100%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" /></p>

<h2 id="stylegan2---ada-ê°„ë‹¨-ìš”ì•½">StyleGAN2 - ada ê°„ë‹¨ ìš”ì•½</h2>
<p>GAN (latent vectorë¡œ ë¶€í„° ì´ë¯¸ì§€ ìƒì„±) ëª¨ë¸ ì¤‘ì—ì„œ<br />
styleGAN (latent vectorë¥¼ style ë³„ë¡œ ìƒì„±ëœ ì—¬ëŸ¬ w-vectorë¡œ ë§Œë“¤ì–´ ì´ë¯¸ì§€ ìƒì„±) ì´ ìˆë‹¤.</p>

<p>adaëŠ” ë°ì´í„° ì¦ê°•ê¸°ë²•(ì ì€ ë°ì´í„°ë¡œ ë‹¤ì–‘í•œ ë°ì´í„°ìƒì„±, ì¼ë°˜í™” íš¨ê³¼ + ë°ì´í„° ìˆ˜ ëŠ˜ë¦¬ëŠ” íš¨ê³¼)</p>

<h2 id="psppixel2style2pixel-ê°„ë‹¨-ìš”ì•½">PSP(pixel2style2pixel) ê°„ë‹¨ ìš”ì•½</h2>
<p>êµ¬ì¡°ë¥¼ ë‘ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆëŠ”ë°,</p>
<ol>
  <li>psp encoder : ì´ë¯¸ì§€ë¥¼ ë§¤í•‘í•˜ì—¬ w-vectorë¥¼ ìƒì„±í•¨.</li>
  <li>styleGAN generator  : w-vectorë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ìƒì„±(styleGAN ë°©ì‹ê³¼ ê°™ì´ í•´ìƒë„ë¥¼ ì˜¬ë¦¬ë©´ì„œ ì´ë¯¸ì§€ ìƒì„±.)</li>
</ol>

<p>ì´ êµ¬ì¡°ë¥¼ ì´ìš©í•´ì„œ ì—¬ëŸ¬ ê¸°ëŠ¥ìœ¼ë¡œ ì‚¬ìš©ê°€ëŠ¥ (ffhq_encode, celeb_seg_to_face, toonify ë“±)</p>

<h2 id="test-ì´ë¯¸ì§€">test ì´ë¯¸ì§€</h2>
<p>styleGAN2-ada, ffhq-pretrained ë¡œ ìƒì„±í•œ ì´ë¯¸ì§€ ë“¤<br />
<img src="/assets/images/project/test_img0.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" />
<img src="/assets/images/project/test_img10.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" />
<img src="/assets/images/project/test_img19.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" />
<img src="/assets/images/project/test_img4.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" />
<img src="/assets/images/project/test_img12.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" />
<img src="/assets/images/project/test_img16.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" /></p>

<h2 id="ê²°ê³¼-ì´ë¯¸ì§€">ê²°ê³¼ ì´ë¯¸ì§€</h2>
<blockquote>
  <p>ìŠ¤íƒ€ì¼ì´ë¯¸ì§€</p>
</blockquote>

<p><img src="/assets/images/project/ë‹¨ë°œ.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" /></p>
<blockquote>
  <p>ê²°ê³¼ ì´ë¯¸ì§€<br />
ìˆœì„œëŒ€ë¡œ <strong>â€œìŠ¤íƒ€ì¼ ì ìš©ì „â€</strong> ::::::: <strong>â€œwë²¡í„° ì¤‘ ëœë¤ìœ¼ë¡œ 1 ê°œë§Œ ì ìš©â€</strong> ::::::: <strong>â€œëª¨ë“  wë²¡í„°ë¥¼ ì ìš©í•œ ê²½ìš°â€</strong></p>
</blockquote>

<p><img src="/assets/images/project/test_img0.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" />
<img src="/assets/images/project/0/mask_some.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" />
<img src="/assets/images/project/0/mask_all.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" /></p>

<p><img src="/assets/images/project/test_img10.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" />
<img src="/assets/images/project/10/mask_some.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" />
<img src="/assets/images/project/10/mask_all.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" /></p>

<p><img src="/assets/images/project/test_img19.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" />
<img src="/assets/images/project/19/mask_some.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" />
<img src="/assets/images/project/19/mask_all.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" /></p>

<h2 id="ê²°ë¡ ">ê²°ë¡ </h2>

<p>ê²°ê³¼ë¥¼ í•´ì„í•˜ìë©´</p>
<ol>
  <li>ìŠ¤íƒ€ì¼ì´ë¯¸ì§€ì˜ ì–¼êµ´í˜•, ë¨¸ë¦¬ìŠ¤íƒ€ì¼ ë“±ì— ì›ë³¸ì´ë¯¸ì§€ì˜ ëˆˆì½”ì…, í”¼ë¶€ ë“±ì„ ì ìš©ì‹œì¼œ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•œë‹¤.</li>
  <li>ëœë¤í•œ wë²¡í„°ë¥¼ ì ìš©í–ˆì„ ë•Œ, ìŠ¤íƒ€ì¼ ì´ë¯¸ì§€ì˜ ì •í™•íˆ ì–´ë–¤ íŠ¹ì§•ì„ ë‹´ì€ wë²¡í„°ê°€ ì ìš©ëœ ê²ƒì¸ì§€ ì•Œê¸° í˜ë“¤ë‹¤..<br />
(ë¬¼ë¡  ìŠ¤íƒ€ì¼ì´ë¯¸ì§€ì™€ ë¬´ì–¸ê°€ ë‹®ì•„ì§€ê¸´ í•œë‹¤.)</li>
</ol>

<p>ì„±ê³µì ì¸ê°€ì˜ ì—¬ë¶€ëŠ” ìŠ¤íƒ€ì¼ ì´ë¼ëŠ” ì• ë§¤í•œ ë‹¨ì–´ì— ì–´ë–¤ ê±¸ í¬í•¨ì‹œí‚¤ëŠëƒì— ë”°ë¼ í•´ì„ì´ ë‹¤ë¥¼ ê²ƒ ê°™ë‹¤.<br />
ì–¼êµ´í˜•, ë¨¸ë¦¬ìŠ¤íƒ€ì¼ì„ â€˜ìŠ¤íƒ€ì¼â€™ì´ë¼ê³  í•œë‹¤ë©´, ì„±ê³µì— ê°€ê¹ë‹¤ê³  ë³¼ ìˆ˜ ìˆê² ë‹¤!<br />
ë‹¤ë§Œ ì›í•˜ëŠ” ìŠ¤íƒ€ì¼(ë¨¸ë¦¬ìŠ¤íƒ€ì¼, ì–¼êµ´í˜• ì¤‘ í•˜ë‚˜ë¥¼ íƒí•˜ê³  ì‹¶ì€ ê²½ìš°)ì„ ì ìš©í•˜ëŠ”ë°ì—ëŠ” ì‹¤í—˜ì ì¸ ì‹œë„ê°€ í•„ìš”í•´ ë³´ì¸ë‹¤.</p>

<h2 id="ë ˆí¬ì§€í† ë¦¬-ë§í¬">ë ˆí¬ì§€í† ë¦¬ ë§í¬</h2>
<p><a href="https://github.com/chan9480/Style_image_GAN">https://github.com/chan9480/Style_image_GAN</a></p>

<p><br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš°
ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„
</code></pre></div></div>

<p><a href="#" class="btn btn--primary align-right">ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°</a></p>]]></content><author><name>ì˜¹ë‹¬ìƒ˜ğŸ‘±ğŸ¼â€â™‚ï¸</name></author><category term="pj" /><category term="styleGAN2" /><category term="PSP" /><summary type="html"><![CDATA[ëª©í‘œ ì„ì˜ì˜ ì´ˆìƒê¶Œ ì—†ëŠ” ì–¼êµ´ì„ íŠ¹ì • ìŠ¤íƒ€ì¼ì„ ì…í˜€ ë§Œë“¤ê¸°.]]></summary></entry><entry><title type="html">ë°ì´í„° ì¸ì½”ë”©(encoding)</title><link href="http://localhost:4000/ds/encoding/" rel="alternate" type="text/html" title="ë°ì´í„° ì¸ì½”ë”©(encoding)" /><published>2022-03-06T00:00:00+09:00</published><updated>2022-03-06T00:00:00+09:00</updated><id>http://localhost:4000/ds/encoding</id><content type="html" xml:base="http://localhost:4000/ds/encoding/"><![CDATA[<h2 id="ì¸ì½”ë”©ì€-ì™œ-í•˜ëŠ”ê±°">ì¸ì½”ë”©ì€ ì™œ í•˜ëŠ”ê±°?</h2>
<p>ë°ì´í„°ì—ëŠ” ì—°ì†ì ì¸ ìˆ«ìë§Œ ìˆëŠ”ê²Œ ì•„ë‹ˆë‹¤.<br />
ë¬¸ìì—´ì˜ ì¹´í…Œê³ ë¦¬í˜• featureì¼ ìˆ˜ë„,<br />
ìˆ«ìë¼ í•˜ë”ë¼ë„ ë¹„ì—°ì†ì ì¸ ì¹´í…Œê³ ë¦¬í˜• featureë„ ìˆë‹¤.<br />
(ì˜ˆ: ì‚¬ëŠ”ì§€ì—­(â€œìˆ˜ìœ ë™â€, â€œì¸ìˆ˜ë™â€ â€¦), í‰ì (â€œë§¤ìš°ë³„ë¡œâ€,â€ë³„ë¡œâ€, â€¦ , â€œë§¤ìš°ì¢‹ìŒâ€))</p>

<p>ì¸ì½”ë”©ì€ ì´ëŸ¬í•œ ì¹´í…Œê³ ë¦¬í˜• featureë“¤ì— ëŒ€í•˜ì—¬ â€˜ë°ì´í„°â€™ë¡œì¨ ìœ ì˜ë¯¸í•˜ë„ë¡ ìˆ«ìë¡œ ë°”ê¿”ì£¼ëŠ” ì—­í• ì„ í•œë‹¤.</p>

<h2 id="ì¸ì½”ë”©ì˜-ì¢…ë¥˜ì™€-ê°„ë‹¨-ì •ë¦¬">ì¸ì½”ë”©ì˜ ì¢…ë¥˜ì™€ ê°„ë‹¨ ì •ë¦¬</h2>
<p>ë³¸ë˜ ë°ì´í„°<br />
<img src="/assets/images/source_27.png" width="30%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" /></p>

<ol>
  <li>One Hot Encoding<br />
í•˜ë‚˜ì˜ featureê°€ ê°–ëŠ” ë²”ì£¼ ì „ì²´ì— ëŒ€í•˜ì—¬ â€˜ì´ë‹¤â€™, â€˜ì•„ë‹ˆë‹¤â€™ë¡œ ë¶„ë¥˜í•˜ì—¬ 0, 1ì„ ê°–ëŠ” featureë¥¼ ìƒì„±.<br />
(ì‚¬ëŠ”ì§€ì—­ì˜ ì¢…ë¥˜ê°€ â€œìˆ˜ìœ ë™â€, â€œìŒë¬¸ë™â€ ë“± 16ê°œì˜ ë™ì´ ìˆë‹¤ë©´, 16ê°œì˜ feature (ì‚¬ëŠ”ì§€ì—­_ìˆ˜ìœ ë™, ì‚¬ëŠ”ì§€ì—­_ìŒë¬¸ë™â€¦ ë“±)
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pd.get_dummies(df, prefix=["ì§€  "], columns=["ì‚¬ëŠ”ì§€ì—­"])
#ë˜ëŠ” ì•„ë˜ì²˜ëŸ¼ sklern.preprocessingì˜ í•¨ìˆ˜ ì‚¬ìš©
from sklearn.preprocessing import OneHotEncoder
</code></pre></div>    </div>
    <p><img src="/assets/images/source_28.png" width="60%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" /></p>
  </li>
  <li>Ordinal Encoding
categorical_featureì˜ ê°’ë“¤ì´ ì–´ë–¤ <strong>â€˜ìˆœì„œâ€™</strong>ë¥¼ ê°–ê³ ìˆì„ ë•Œ ì‚¬ìš©í•œë‹¤.<br />
(â€˜ë§¤ìš° ê·¸ë ‡ë‹¤â€™, â€˜ê·¸ë ‡ë‹¤â€™, â€˜ë³´í†µâ€™, â€˜ì•„ë‹ˆë‹¤â€™, â€˜ë§¤ìš° ì•„ë‹ˆë‹¤â€™) ê°™ì€ê±°!
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from sklearn.preprocessing import OrdinalEncoder
enc = OrdinalEncoder(categories = [['ë¶ˆë§Œì¡±', 'ë³´í†µ', 'ë§Œì¡±']])
df['ì„ í˜¸ë„_enc']=enc.fit_transform(df[['ì„ í˜¸ë„']])
</code></pre></div>    </div>
    <p><img src="/assets/images/source_29.png" width="20%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" /></p>
  </li>
  <li>Binary Encoding
OneHotEncodingì˜ ì´ì§„ìˆ˜ ë²„ì „ì´ë¼ê³  ì´í•´í–ˆë‹¤.<br />
ì‚¬ëŠ”ì§€ì—­ì˜ ì¢…ë¥˜ê°€ 16ê°œì˜ ë™ì´ ìˆë‹¤ë©´. 4ìë¦¬ ì´ì§„ìˆ˜ë¡œ í‘œí˜„ì´ ê°€ëŠ¥í•˜ë¯€ë¡œ <strong>4ê°œì˜ featureë¥¼ ìƒì„±</strong> í•œë‹¤.(cardinalityê°€ ë„ˆë¬´ í° íŠ¹ì„±ì— ëŒ€í•´ì„œ ì‚¬ìš©í•˜ë©´ ì¥ì ì¼ ë“¯!)<br />
â€˜ìˆ˜ìœ ë™ì€â€™ 4ê°œì˜ featureì— 0ì´ë‚˜ 1ì´ ì±„ì›Œì ¸ 0000ë¶€í„° 1111ì¤‘ í•˜ë‚˜ì˜ í˜•íƒœë¥¼ ê°€ì§ˆ ê²ƒ!
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import category_encoders as ce
encoder = ce.BinaryEncoder(cols=['ì‚¬ëŠ”ì§€ì—­'])
dfbin = encoder.fit_transform(df['ì‚¬ëŠ”ì§€ì—­'])
df = pd.concat([df, dfbin], axis=1)
df.drop(['ì„ í˜¸ë„','ì„±ë³„(1ë‚¨, 0ì—¬)'], axis=1)
</code></pre></div>    </div>
    <p><img src="/assets/images/source_30.png" width="30%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" /></p>
  </li>
  <li>Frequency Encoding
ë¹ˆë„ë¡œì¨ í‘œí˜„í•˜ëŠ” ë°©ë²•<br />
â€˜ìˆ˜ìœ ë™â€™ì´ 10ê°œ ë°ì´í„°ì¤‘ 2ë²ˆìˆë‹¤ë©´ 0.2ë¡œ ë§¤í•‘ë¨.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Frequency Encoding
fe = df.groupby("ì‚¬ëŠ”ì§€ì—­").size()/len(df)
df.loc[:, "ì‚¬ëŠ”ì§€ì—­_freq_encode"] = df["ì‚¬ëŠ”ì§€ì—­"].map(fe)
df
</code></pre></div>    </div>
    <p><img src="/assets/images/source_31.png" width="30%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" /></p>
  </li>
  <li>
    <p>Mean Encoding<br />
ì—¬ê¸°ë¶€í„°ëŠ” ì§€ë„í•™ìŠµì—ë§Œ í•´ë‹¹í•˜ëŠ” ë‚´ìš©ì´ë¼ê³  ìƒê°í•œë‹¤. <strong>â€˜targetâ€™</strong> ì´ ì¡´ì¬í•  ë•Œë§Œ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸!<br />
ì–´ë–»ê²Œ ì¸ì½”ë”©ì„ ì‹œí‚¬ ì§€ë¥¼ â€˜íƒ€ê²Ÿì˜ í‰ê· ê°’â€™ì— ë”°ë¼ ê²°ì •í•œë‹¤.</p>

    <p>ë¨¼ì €, ë‹¨ìˆœí•˜ê²Œ targetì˜ í‰ê· ìì²´ë¡œ ë§¤í•‘ì„ í•˜ëŠ” ë°©ë²•ì´ ìˆëŠ”ë°,<br />
(targetì„ genderë¼ í•˜ë©´, ìˆ˜ìœ ë™ì—ì‚¬ëŠ” ì‚¬ëŒë“¤ì˜ targetí‰ê· ì„ ìˆ˜ìœ ë™ì˜ ì¸ì½”ë”© ë§¤í•‘ê°’ìœ¼ë¡œ ì‚¼ëŠ”ë‹¤.)<br />
ê³¼ì í•©ì´ ë˜ê¸° ì‰½ë‹¤.<br />
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“</p>

    <p>ë‘ë²ˆì§¸ë¡œ, smoothing mean target encodingì€ ê³¼ì í•©ì„ ì¢€ë” ë°©ì§€í•œë‹¤.<br />
(ìˆ˜ìœ ë™ ì‚¬ëŒë“¤ì˜ targetí‰ê·  / weight) + (ì „ì²´ targetí‰ê·  / ìˆ˜ìœ ë™ì˜ ê°¯ìˆ˜)<br />
 ì˜ë¯¸ : weightë¡œ ê°œë³„í‰ê· ì„ ë¶„ì‚°ì‹œì¼œì£¼ê³ , ìˆ˜ìœ ë™ì˜ ê°¯ìˆ˜ê°€ í´ìˆ˜ë¡ ìˆ˜ìœ ë™í‰ê· ì— í˜ì„, ìˆ˜ìœ ë™ ê°¯ìˆ˜ê°€ ì ë‹¤ë©´ ì „ì²´í‰ê· ì˜ í˜ì„ ì‹¤ì–´ì¤€ë‹¤.<br />
weightê°€ í´ìˆ˜ë¡ í¸ì°¨ê°€ ì‘ì•„ì§„ë‹¤!</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> # smoothing target encoding
 # 1. í‰ê· ì„ ê³„ì‚°
 mean = df['ì„±ë³„(1ë‚¨, 0ì—¬)'].mean()
 # 2. ê° ê·¸ë£¹ì— ëŒ€í•œ ê°’ë“¤ì˜ ë¹ˆë„ì™€ í‰ê· ì„ ê³„ì‚°
 Agg = df.groupby('ì‚¬ëŠ”ì§€ì—­')['ì„±ë³„(1ë‚¨, 0ì—¬)'].agg(['count', 'mean'])
 counts = Agg['count']
 means = Agg['mean']
 weight = 10
 # 3. â€œsmoothâ€í•œ í‰ê· ì„ ê³„ì‚°
 smooth = (counts * means + weight * mean) / (counts + weight)
 # smoothí•œ í‰ê· ì— ë”°ë¼ ê° ê°’ì„ ëŒ€ì²´í•˜ëŠ” ê²ƒ
 print(smooth)
 df.loc[:, 'ì‚¬ëŠ”ì§€ì—­_smean_enc'] = df['ì‚¬ëŠ”ì§€ì—­'].map(smooth)
 df
</code></pre></div>    </div>
    <p><img src="/assets/images/source_32.png" width="60%" height="60%" title="ì œëª©" alt="ì•„ë¬´ê±°ë‚˜" /></p>
  </li>
  <li>Probability Ratio Encoding (í™•ë¥ ë¹„ìœ¨ ì¸ì½”ë”©)<br />
(targetì´ 1ì¸ í™•ë¥  / targetì´ 0ì¸ í™•ë¥ ) ì˜ ë¹„ìœ¨ë¡œ ë§¤í•‘ì„ í•˜ëŠ” ë°©ë²•ì´ë‹¤.<br />
ì£¼ì˜í•  ì ì€ 0ìœ¼ë¡œë‚˜ë‰˜ëŠ”ê±¸ ê¼­ ë°©ì§€í•˜ì!  <br />
(ì˜ˆ : â€˜ìˆ˜ìœ ë™â€™ë“¤ ì¤‘ì— targetì´ 1ì¸ê°¯ìˆ˜ëŠ” 3ê°œ, 0ì¸ê°¯ìˆ˜ëŠ” 1ê°œë¼ë©´, â€˜ìˆ˜ìœ ë™â€™ì€ 3ìœ¼ë¡œ ë§¤í•‘ë¨.)</li>
  <li>Weight of Evidence Encoding<br />
ìœ„ PREì˜ ë¹„ìœ¨ì— log_2ë¥¼ ì·¨í•˜ê³  weightì„ ê³±í•´ì¤€ ê²ƒìœ¼ë¡œ ì¸ì½”ë”©í•˜ëŠ” ë°©ë²•.<br />
(6ë²ˆ ì¸ì½”ë”© ì˜ˆì‹œì—ì„œ â€˜ìˆ˜ìœ ë™â€™ì€ w*ln(3)ì˜ ê°’ìœ¼ë¡œ ë§¤í•‘ ë  ê²ƒ.)</li>
</ol>

<p><br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš°
ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„
</code></pre></div></div>

<p><a href="#" class="btn btn--primary align-right">ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°</a></p>]]></content><author><name>ì˜¹ë‹¬ìƒ˜ğŸ‘±ğŸ¼â€â™‚ï¸</name></author><category term="ds" /><summary type="html"><![CDATA[ì¸ì½”ë”©ì€ ì™œ í•˜ëŠ”ê±°? ë°ì´í„°ì—ëŠ” ì—°ì†ì ì¸ ìˆ«ìë§Œ ìˆëŠ”ê²Œ ì•„ë‹ˆë‹¤. ë¬¸ìì—´ì˜ ì¹´í…Œê³ ë¦¬í˜• featureì¼ ìˆ˜ë„, ìˆ«ìë¼ í•˜ë”ë¼ë„ ë¹„ì—°ì†ì ì¸ ì¹´í…Œê³ ë¦¬í˜• featureë„ ìˆë‹¤. (ì˜ˆ: ì‚¬ëŠ”ì§€ì—­(â€œìˆ˜ìœ ë™â€, â€œì¸ìˆ˜ë™â€ â€¦), í‰ì (â€œë§¤ìš°ë³„ë¡œâ€,â€ë³„ë¡œâ€, â€¦ , â€œë§¤ìš°ì¢‹ìŒâ€))]]></summary></entry><entry><title type="html">í¬ë¡¤ë§(Crawling)</title><link href="http://localhost:4000/de/crawling/" rel="alternate" type="text/html" title="í¬ë¡¤ë§(Crawling)" /><published>2022-03-05T00:00:00+09:00</published><updated>2022-03-20T00:00:00+09:00</updated><id>http://localhost:4000/de/crawling</id><content type="html" xml:base="http://localhost:4000/de/crawling/"><![CDATA[<h2 id="í¬ë¡¤ë§ì´ë€-">í¬ë¡¤ë§ì´ë€ ?</h2>
<p>webì— ìˆëŠ” ë°ì´í„°ë“¤ì„ ê¸ì–´ëª¨ìœ¼ëŠ” ê²ƒì„ ë§í•œë‹¤.<br />
í¬ê²Œ ë‘ ì¢…ë¥˜ë¡œ ë¨¼ì € ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.</p>
<ol>
  <li>ì •ì í¬ë¡¤ë§ : í•­ìƒ ê°™ì€ ê°’ì„ ì£¼ëŠ” HTMLë¡œ ë¶€í„° íŒŒì‹±ì„ í•´ì„œ í¬ë¡¤ë§.</li>
  <li>ë™ì í¬ë¡¤ë§ : ê°™ì€ HTMLì´ë¼ë„ ë™ì‘, ëª…ë ¹ì„ í†µí•´ ë³€í™”ëœ ìƒíƒœì—ì„œ ë°ì´í„°ë“¤ì„ í¬ë¡¤ë§.</li>
</ol>

<p>ì •ì í¬ë¡¤ë§ì€ ë©ˆì¶°ìˆëŠ” í˜ì´ì§€ì—ì„œ ì •ë³´ë¥¼ ì°¾ì•„ ê¸ì–´ëª¨ì€ë‹¤ë©´,<br />
ë™ì í¬ë¡¤ë§ì€ ê²€ìƒ‰, ìŠ¤í¬ë¡¤, í˜ì´ì§€ í´ë¦­ ë“±ì„ í•´ì„œ ë‚˜ì˜¤ëŠ” ì •ë³´ë¥¼ ê¸ì–´ëª¨ì„ ìˆ˜ ìˆë‹¤.</p>

<p>ëŒ€í‘œì ìœ¼ë¡œ ì •ì í¬ë¡¤ë§ ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ beautifulsoup(bs4)ê°€ ìˆë‹¤.<br />
ê·¸ë¦¬ê³  ë™ì í¬ë¡¤ë§ì˜ ë°©ë²•ì—ë„ ì—¬ëŸ¬ ì¢…ë¥˜ê°€ ìˆëŠ”ë° ê·¸ ì¤‘ 2ê°€ì§€ë¥¼ ì ì–´ë³´ìë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ol>
  <li>openAPIë¥¼ ì´ìš©í•˜ì—¬ ëª…ë ¹ í›„, responseëœ ì •ë³´ë¡œë¶€í„° í¬ë¡¤ë§.</li>
  <li>seleniumì„ í†µí•´ webdriver (í¬ë¡¬, ì‚¬íŒŒë¦¬ ë“±)ë¥¼ ì œì–´í•œ í›„ ë‚˜ì˜¨ í˜ì´ì§€(HTML)ë¡œë¶€í„° í¬ë¡¤ë§.</li>
</ol>

<h2 id="í¬ë¡¤ë§-ì˜ˆì‹œ">í¬ë¡¤ë§ ì˜ˆì‹œ</h2>
<p>ë¨¼ì € ì•„ë˜ í•¨ìˆ˜ ë‘ê°œë¥¼ ì§€ì •í•˜ê² ë‹¤.</p>
<ol>
  <li>diScrollDown : íŠ¹ì • ì‹œê°„ë™ì•ˆ ìŠ¤í¬ë¡¤ì„ ë‚´ë¦¬ëŠ” í•¨ìˆ˜.</li>
  <li>createDirectory : ì…ë ¥ê°’ìœ¼ë¡œ ë°›ì€ ë¬¸ìì—´(ê²½ë¡œ)ì— í•´ë‹¹í•˜ëŠ” í´ë”ë¥¼ ìƒì„±í•œë‹¤.</li>
  <li>crawling_img : ì…ë ¥ê°’ìœ¼ë¡œ ë°›ì€ ë¬¸ìì—´ì„ í¬ë¡¬ì—ì„œ ê²€ìƒ‰í•´ì„œ í•¨ìˆ˜ë‚´ì— ì§€ì •ë˜ì–´ ìˆëŠ”(ì§ì ‘ë³€ê²½) ê²½ë¡œë¡œ ì´ë¯¸ì§€ë¥¼ ì €ì¥. (ì´ë¦„ì€ ë²ˆí˜¸ìˆœìœ¼ë¡œ ì¦ê°€)</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from selenium import webdriver
from selenium.webdriver.common.keys import Keys
import time
import urllib.request
import os

def doScrollDown(driver, whileSeconds):
    start = datetime.datetime.now()
    end = start + datetime.timedelta(seconds=whileSeconds)
    while True:
        driver.execute_script('window.scrollTo(0, document.body.scrollHeight);')
        time.sleep(1)
        if datetime.datetime.now() &gt; end:
            break

def createDirectory(directory):
    try:
        if not os.path.exists(directory):
            os.makedirs(directory)
    except OSError:
        print("Error: Failed to create the directory.")

def crawling_img(name):
    ## ì…ë ¥ê°’ name ë¬¸ìì—´ì„ ê²€ìƒ‰í•˜ì—¬ ë‚˜ì˜¤ëŠ” ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ëŠ” í•¨ìˆ˜.
    ## ì €ì¥í•˜ëŠ” ê²½ë¡œëŠ” í•¨ìˆ˜ ë‚´ì—ì„œ ë³„ë„ë¡œ ì§€ì •í•´ì•¼í•¨.

    # í¬ë¡¬ì„ ë“œë¼ì´ë²„ë¡œ ì±„íƒ. ë²„ì „ì˜¤ë¥˜ê°€ ë‚  ìˆ˜ ìˆë‹¤.
    # ì‚¬íŒŒë¦¬ëŠ” webdriver.Safari()ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
    driver = webdriver.Chrome()
    driver.get("https://www.google.co.kr/imghp?hl=ko&amp;tab=wi&amp;authuser=0&amp;ogbl")

    # që¡œ íƒœê·¸ë˜ì–´ ìˆëŠ” ê³³ì´ êµ¬ê¸€í™ˆí˜ì´ì§€ì˜ ê²€ìƒ‰ì°½ì´ë‹¤.
    # driver.set_window_size(a,b) ë¡œ ì°½ í¬ê¸° ì§€ì • ê°€ëŠ¥
    elem = driver.find_element_by_name("q")
    elem.send_keys(name)
    elem.send_keys(Keys.RETURN)


    SCROLL_PAUSE_TIME = 1   # 1ì´ˆì”© ê¸°ë‹¤ë ¸ë‹¤ê°€ ë‚´ë ¸ë‹¤ë¥¼ ë°˜ë³µí• ê±°ì„.  
    # Get scroll height
    last_height = driver.execute_script("return document.body.scrollHeight")  # ë¸Œë¼ìš°ì €ì˜ ë†’ì´ë¥¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì°¾ìŒ
    while True:
        # Scroll down to bottom
        driver.execute_script("window.scrollTo(0, document.body.scrollHeight);")  # ë¸Œë¼ìš°ì € ëê¹Œì§€ ìŠ¤í¬ë¡¤ì„ ë‚´ë¦¼
        # Wait to load page
        time.sleep(SCROLL_PAUSE_TIME)
        # Calculate new scroll height and compare with last scroll height
        new_height = driver.execute_script("return document.body.scrollHeight")
        if new_height == last_height:
            try:
                # ë”ë³´ê¸° ë²„íŠ¼ì„ í´ë¦­í•  ê±°ì„.
                driver.find_element_by_css_selector(".mye4qd").click()
            except:
                # ë”ë³´ê¸° ë²„íŠ¼ì´ ì—†ì–´ì„œ í´ë¦­ì„ ëª»í•˜ë©´ ë.
                break
        last_height = new_height

    imgs = driver.find_elements_by_css_selector(".rg_i.Q4LuWd")

    # ê²½ë¡œì™€ í´ë” ëª… ì§€ì •.
    dir = ".\tree_flower_dog_cat" + "\\" + name

    createDirectory(dir) #í´ë” ìƒì„±
    count = 1
    for img in imgs:
        try:
            img.click()
            time.sleep(3)
            imgUrl = driver.find_element_by_xpath(
                '//*[@id="Sva75c"]/div/div/div[3]/div[2]/c-wiz/div/div[1]/div[1]/div[2]/div/a/img').get_attribute(
                "src")
            path = ".\idols\\" + name + "\\"
            urllib.request.urlretrieve(imgUrl, path + name + "_"+ str(count) + ".jpg")

            # ì´ ì•„ë˜ëŠ” ê´€ë ¨ì´ë¯¸ì§€ ì €ì¥
            imgUrl = driver.find_element_by_xpath(
                '//*[@id="Sva75c"]/div/div/div[3]/div[2]/c-wiz/div/div[1]/div[3]/div[3]/c-wiz/div/div/div/div[3]/div[1]/div[1]/a[1]/div[1]/img').get_attribute(
                "src")
            urllib.request.urlretrieve(imgUrl, path + name + "_"+ str(count) + "_1" + ".jpg")
            imgUrl = driver.find_element_by_xpath(
                '//*[@id="Sva75c"]/div/div/div[3]/div[2]/c-wiz/div/div[1]/div[3]/div[3]/c-wiz/div/div/div/div[3]/div[1]/div[2]/a[1]/div[1]/img').get_attribute(
                "src")
            urllib.request.urlretrieve(imgUrl, path + name + "_"+ str(count) + "_2" + ".jpg")

            imgUrl = driver.find_element_by_xpath(
                '//*[@id="Sva75c"]/div/div/div[3]/div[2]/c-wiz/div/div[1]/div[3]/div[3]/c-wiz/div/div/div/div[3]/div[1]/div[3]/a[1]/div[1]/img').get_attribute(
                "src")
            urllib.request.urlretrieve(imgUrl, path + name + "_"+ str(count) + "_3" + ".jpg")

            count = count + 1
            if count &gt;= 500:
                break
        except:
            pass
    driver.close()
</code></pre></div></div>

<p>ì´ì œ ìœ„ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ forë¬¸ì„í†µí•´ ê²€ìƒ‰ ë° ì €ì¥ì„ ë™ì‹œì— í•´ì£¼ë©´ ëœë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>searching_keyword = ["ë‚˜ë¬´", "ê½ƒ", "ê°•ì•„ì§€ì–¼êµ´", "ê³ ì–‘ì´ì–¼êµ´"]

for i in range(len(searching_keyword)) :
    searching_keyword[i] += '_ì‚¬ì§„' # ì‚¬ì§„ì„ ë’¤ì— ë¶™ì´ë©´ ê²€ìƒ‰ì´ ì˜ë  ê²ƒ ê°™ì•„!

for keyword in searching_keyword:
    crawling_img(keyword)
</code></pre></div></div>

<p><br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš°
ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„
</code></pre></div></div>

<p><a href="#" class="btn btn--primary align-right">ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°</a></p>]]></content><author><name>ì˜¹ë‹¬ìƒ˜ğŸ‘±ğŸ¼â€â™‚ï¸</name></author><category term="de" /><summary type="html"><![CDATA[í¬ë¡¤ë§ì´ë€ ? webì— ìˆëŠ” ë°ì´í„°ë“¤ì„ ê¸ì–´ëª¨ìœ¼ëŠ” ê²ƒì„ ë§í•œë‹¤. í¬ê²Œ ë‘ ì¢…ë¥˜ë¡œ ë¨¼ì € ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤. ì •ì í¬ë¡¤ë§ : í•­ìƒ ê°™ì€ ê°’ì„ ì£¼ëŠ” HTMLë¡œ ë¶€í„° íŒŒì‹±ì„ í•´ì„œ í¬ë¡¤ë§. ë™ì í¬ë¡¤ë§ : ê°™ì€ HTMLì´ë¼ë„ ë™ì‘, ëª…ë ¹ì„ í†µí•´ ë³€í™”ëœ ìƒíƒœì—ì„œ ë°ì´í„°ë“¤ì„ í¬ë¡¤ë§.]]></summary></entry></feed>