I"„<p class="notice--warning">ìµœí¥ë°°ë‹˜ì˜ ì±… <strong>Boost.Asioë¥¼ ì‚¬ìš©í•œ ë„¤íŠ¸ì›Œí¬ í”„ë¡œê·¸ë˜ë°</strong> ì„ ê³µë¶€í•˜ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€</p>

<h1 id="chapter-3-ë¹„ë™ê¸°-io-ë°©ì‹ì˜-tcpip-echo-ì„œë²„-í´ë¼ì´ì–¸íŠ¸-í”„ë¡œê·¸ë¨-ë§Œë“¤ê¸°">Chapter 3. ë¹„ë™ê¸° I/O ë°©ì‹ì˜ TCP/IP Echo ì„œë²„, í´ë¼ì´ì–¸íŠ¸ í”„ë¡œê·¸ë¨ ë§Œë“¤ê¸°</h1>

<h2 id="-ë¹„ë™ê¸°-io-í”„ë¡œê·¸ë˜ë°ì˜-íŠ¹ì§•">ğŸ”” ë¹„ë™ê¸° I/O í”„ë¡œê·¸ë˜ë°ì˜ íŠ¹ì§•</h2>

<blockquote>
  <p>A ë¼ëŠ” ì‘ì—…ì„ ìš”ì²­í•˜ë©´ A ì‘ì—…ì´ ì™„ë£Œë ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ë‹¤ìŒ ì‘ì—…ì„ ì§„í–‰í•˜ë‹¤ê°€ A ì‘ì—…ì´ ëë‚˜ë©´ ë‹¤ì‹œ ëŒì•„ì™€ A ì˜ ë‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ì‹ì´ë‹¤.</p>
</blockquote>

<ul>
  <li>ì‘ì—… íë¦„ì— ëŒ€ê¸°ê°€ ì—†ì´ ì‹ ì†í•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ ì‘ì—…ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ë¹„ë™ê¸° ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ì—ëŠ” ì•ì— <code class="language-plaintext highlighter-rouge">async</code>ì„ í‘œê¸°í•œë‹¤.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>async_ë•¡ë•¡ (ìš”ì²­ ì‘ì—…ì— ì‚¬ìš©í•  ì¸ìˆ˜, ìš”ì²­í•œ ì‘ì—…ì´ ëë‚˜ë©´ í˜¸ì¶œí•  í•¨ìˆ˜ í¬ì¸í„°)
</code></pre></div>    </div>
    <ul>
      <li>ì˜ˆë¥¼ ë“¤ì–´ ì•„ë˜ì™€ ê°™ì€ ê²½ìš° ë°ì´í„°ë¥¼ ì½ëŠ” <code class="language-plaintext highlighter-rouge">async_read</code> í•¨ìˆ˜ëŠ” ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ì´ ëœë‹¤. <code class="language-plaintext highlighter-rouge">async_read</code> í•¨ìˆ˜ë¥¼ ì²˜ë¦¬í•˜ëŠ”ë° <code class="language-plaintext highlighter-rouge">Buffer</code> ì¸ìˆ˜ê°€ í•„ìš”í•˜ë©° (ì½ì€ ë°ì´í„°ë¥¼ ì—¬ê¸°ì— ë‹´ëŠ”ë‹¤) ê·¸ë¦¬ê³  í•¨ìˆ˜ ì‹¤í–‰ì´ ëë‚˜ë©´ <code class="language-plaintext highlighter-rouge">Session::OnRead</code> ë©¤ë²„ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤.</li>
      <li><u>`async_read` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ì´ í•¨ìˆ˜ ì‹¤í–‰ì´ ëë‚  ë•Œ ê¹Œì§€ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ë‹¤ë¥¸ ì‘ì—…ì„ í•˜ëŸ¬ ê°„ë‹¤.</u> <u>ë‹¤ë¥¸ ì‘ì—…ì„ í•˜ë˜ ë„ì¤‘ `async_read` í•¨ìˆ˜ ì‘ì—…ì´ ì™„ë£Œë˜ë©´ `Session::OnRead` ë©¤ë²„ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.</u>
        <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">async_read</span><span class="p">(</span><span class="n">Buffer</span><span class="p">,</span> <span class="n">Session</span><span class="o">::</span><span class="n">OnRead</span><span class="p">)</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="-ì„œë²„">ğŸ”” ì„œë²„</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;SDKDDKVer.h&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;string&gt;
#include &lt;list&gt;
#include &lt;boost/bind.hpp&gt;
#include &lt;boost/asio.hpp&gt;
</span>


<span class="k">class</span> <span class="nc">Session</span>
<span class="p">{</span>
<span class="nl">private:</span>
	<span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">socket</span> <span class="n">m_Socket</span><span class="p">;</span>
	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">m_WriteMessage</span><span class="p">;</span>
	<span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="mi">128</span><span class="o">&gt;</span> <span class="n">m_ReceiveBuffer</span><span class="p">;</span>

<span class="nl">public:</span>
	<span class="n">Session</span><span class="p">(</span><span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">io_service</span><span class="o">&amp;</span> <span class="n">io_service</span><span class="p">)</span>
		<span class="o">:</span> <span class="n">m_Socket</span><span class="p">(</span><span class="n">io_service</span><span class="p">)</span>
	<span class="p">{</span>
	<span class="p">}</span>

	<span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">socket</span><span class="o">&amp;</span> <span class="n">Socket</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="n">m_Socket</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="kt">void</span> <span class="n">PostReceive</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">m_ReceiveBuffer</span><span class="p">,</span> <span class="sc">'\0'</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">m_ReceiveBuffer</span><span class="p">));</span>

		<span class="n">m_Socket</span><span class="p">.</span><span class="n">async_read_some</span>
		<span class="p">(</span><span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">m_ReceiveBuffer</span><span class="p">),</span> <span class="n">boost</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Session</span><span class="o">::</span><span class="n">handle_receive</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">error</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">bytes_transferred</span><span class="p">));</span>

	<span class="p">}</span>


<span class="nl">private:</span>
	<span class="kt">void</span> <span class="n">handle_write</span><span class="p">(</span><span class="k">const</span> <span class="n">boost</span><span class="o">::</span><span class="n">system</span><span class="o">::</span><span class="n">error_code</span><span class="o">&amp;</span> <span class="cm">/*error*/</span><span class="p">,</span> <span class="kt">size_t</span> <span class="cm">/*bytes_transferred*/</span><span class="p">)</span>
	<span class="p">{}</span>

	<span class="kt">void</span> <span class="n">handle_receive</span><span class="p">(</span><span class="k">const</span> <span class="n">boost</span><span class="o">::</span><span class="n">system</span><span class="o">::</span><span class="n">error_code</span><span class="o">&amp;</span> <span class="n">error</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">bytes_transferred</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">error</span> <span class="o">==</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">error</span><span class="o">::</span><span class="n">eof</span><span class="p">)</span>
				<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"í´ë¼ì´ì–¸íŠ¸ì™€ ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
			<span class="k">else</span>
				<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"error No: "</span> <span class="o">&lt;&lt;</span> <span class="n">error</span><span class="p">.</span><span class="n">value</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">" error Message: "</span> <span class="o">&lt;&lt;</span> <span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">else</span>
		<span class="p">{</span>
			<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">strRecvMessage</span> <span class="o">=</span> <span class="n">m_ReceiveBuffer</span><span class="p">.</span><span class="n">data</span><span class="p">();</span>
			<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë°›ì€ ë©”ì‹œì§€: "</span> <span class="o">&lt;&lt;</span> <span class="n">strRecvMessage</span> <span class="o">&lt;&lt;</span> <span class="s">", ë°›ì€ í¬ê¸°: "</span> <span class="o">&lt;&lt;</span> <span class="n">bytes_transferred</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

			<span class="kt">char</span> <span class="n">szMessage</span><span class="p">[</span><span class="mi">128</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="p">};</span>
			<span class="n">sprintf_s</span><span class="p">(</span><span class="n">szMessage</span><span class="p">,</span> <span class="mi">128</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"Re:%s"</span><span class="p">,</span> <span class="n">strRecvMessage</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
			<span class="n">m_WriteMessage</span> <span class="o">=</span> <span class="n">szMessage</span><span class="p">;</span>

			<span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">async_write</span><span class="p">(</span><span class="n">m_Socket</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">m_WriteMessage</span><span class="p">),</span><span class="n">boost</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Session</span><span class="o">::</span><span class="n">handle_write</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">error</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">bytes_transferred</span><span class="p">));</span>

			<span class="n">PostReceive</span><span class="p">();</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>

<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">PORT_NUMBER</span> <span class="o">=</span> <span class="mi">31400</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">TCP_Server</span>
<span class="p">{</span>
<span class="nl">private:</span>
	<span class="kt">int</span> <span class="n">m_nSeqNumber</span><span class="p">;</span>
	<span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">acceptor</span> <span class="n">m_acceptor</span><span class="p">;</span>
	<span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">io_service</span><span class="o">&amp;</span> <span class="n">m_io_service</span><span class="p">;</span>
	<span class="n">Session</span><span class="o">*</span> <span class="n">m_pSession</span><span class="p">;</span>

<span class="nl">public:</span>
	<span class="n">TCP_Server</span><span class="p">(</span><span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">io_service</span><span class="o">&amp;</span> <span class="n">io_service</span><span class="p">)</span>
		<span class="o">:</span> <span class="n">m_io_service</span><span class="p">(</span><span class="n">io_service</span><span class="p">),</span> <span class="n">m_acceptor</span><span class="p">(</span><span class="n">io_service</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">endpoint</span><span class="p">(</span><span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">v4</span><span class="p">(),</span> <span class="n">PORT_NUMBER</span><span class="p">))</span>
	<span class="p">{</span>
		<span class="n">m_pSession</span> <span class="o">=</span> <span class="nb">nullptr</span><span class="p">;</span>
		<span class="n">StartAccept</span><span class="p">();</span>
	<span class="p">}</span>

	<span class="o">~</span><span class="n">TCP_Server</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">m_pSession</span> <span class="o">!=</span> <span class="nb">nullptr</span><span class="p">)</span>
			<span class="k">delete</span> <span class="n">m_pSession</span><span class="p">;</span>
	<span class="p">}</span>

<span class="nl">private:</span>
	<span class="kt">void</span> <span class="n">StartAccept</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"í´ë¼ì´ì–¸íŠ¸ ì ‘ì† ëŒ€ê¸°....."</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

		<span class="n">m_pSession</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Session</span><span class="p">(</span><span class="n">m_io_service</span><span class="p">);</span>

		<span class="n">m_acceptor</span><span class="p">.</span><span class="n">async_accept</span><span class="p">(</span><span class="n">m_pSession</span><span class="o">-&gt;</span><span class="n">Socket</span><span class="p">(),</span> <span class="n">boost</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">TCP_Server</span><span class="o">::</span><span class="n">handle_accept</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="n">m_pSession</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">error</span><span class="p">));</span>
	<span class="p">}</span>

	<span class="kt">void</span> <span class="n">handle_accept</span><span class="p">(</span><span class="n">Session</span><span class="o">*</span> <span class="n">pSession</span><span class="p">,</span> <span class="k">const</span> <span class="n">boost</span><span class="o">::</span><span class="n">system</span><span class="o">::</span><span class="n">error_code</span><span class="o">&amp;</span> <span class="n">error</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"í´ë¼ì´ì–¸íŠ¸ ì ‘ì† ì„±ê³µ"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

			<span class="n">pSession</span><span class="o">-&gt;</span><span class="n">PostReceive</span><span class="p">();</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">io_service</span> <span class="n">io_service</span><span class="p">;</span>

	<span class="n">TCP_Server</span> <span class="n">server</span><span class="p">(</span><span class="n">io_service</span><span class="p">);</span>

	<span class="n">io_service</span><span class="p">.</span><span class="n">run</span><span class="p">();</span>


	<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"ë„¤íŠ¸ì› ì ‘ì† ì¢…ë£Œ"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

	<span class="n">getchar</span><span class="p">();</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="-í´ë¼ì´ì–¸íŠ¸">ğŸ”” í´ë¼ì´ì–¸íŠ¸</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;SDKDDKVer.h&gt;
#include &lt;iostream&gt;
#include &lt;boost/bind.hpp&gt;
#include &lt;boost/asio.hpp&gt;
</span>

<span class="k">const</span> <span class="kt">char</span> <span class="n">SERVER_IP</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"127.0.0.1"</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">PORT_NUMBER</span> <span class="o">=</span> <span class="mi">31400</span><span class="p">;</span>


<span class="k">class</span> <span class="nc">TCP_Client</span>
<span class="p">{</span>
<span class="nl">private:</span>
	<span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">io_service</span><span class="o">&amp;</span> <span class="n">m_io_service</span><span class="p">;</span>
	<span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">socket</span> <span class="n">m_Socket</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">m_nSeqNumber</span><span class="p">;</span>
	<span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="mi">128</span><span class="o">&gt;</span> <span class="n">m_ReceiveBuffer</span><span class="p">;</span>
	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">m_WriteMessage</span><span class="p">;</span>

<span class="nl">public:</span>
	<span class="n">TCP_Client</span><span class="p">(</span><span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">io_service</span><span class="o">&amp;</span> <span class="n">io_service</span><span class="p">)</span>
		<span class="o">:</span> <span class="n">m_io_service</span><span class="p">(</span><span class="n">io_service</span><span class="p">),</span>
		<span class="n">m_Socket</span><span class="p">(</span><span class="n">io_service</span><span class="p">),</span>
		<span class="n">m_nSeqNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
	<span class="p">{}</span>

	<span class="kt">void</span> <span class="n">Connect</span><span class="p">(</span><span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">endpoint</span><span class="o">&amp;</span> <span class="n">endpoint</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">m_Socket</span><span class="p">.</span><span class="n">async_connect</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span>
			<span class="n">boost</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">TCP_Client</span><span class="o">::</span><span class="n">handle_connect</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">error</span><span class="p">));</span>
	<span class="p">}</span>


<span class="nl">private:</span>
	<span class="kt">void</span> <span class="n">PostWrite</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">m_Socket</span><span class="p">.</span><span class="n">is_open</span><span class="p">()</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span>
			<span class="k">return</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">m_nSeqNumber</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">m_Socket</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
			<span class="k">return</span><span class="p">;</span>
		<span class="p">}</span>


		<span class="o">++</span><span class="n">m_nSeqNumber</span><span class="p">;</span>

		<span class="kt">char</span> <span class="n">szMessage</span><span class="p">[</span><span class="mi">128</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="p">};</span>
		<span class="n">sprintf_s</span><span class="p">(</span><span class="n">szMessage</span><span class="p">,</span> <span class="mi">128</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"%d - Send Message"</span><span class="p">,</span> <span class="n">m_nSeqNumber</span><span class="p">);</span>

		<span class="n">m_WriteMessage</span> <span class="o">=</span> <span class="n">szMessage</span><span class="p">;</span>

		<span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">async_write</span><span class="p">(</span><span class="n">m_Socket</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">m_WriteMessage</span><span class="p">),</span> <span class="n">boost</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">TCP_Client</span><span class="o">::</span><span class="n">handle_write</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">error</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">bytes_transferred</span><span class="p">));</span>

		<span class="n">PostReceive</span><span class="p">();</span>
	<span class="p">}</span>

	<span class="kt">void</span> <span class="n">PostReceive</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">m_ReceiveBuffer</span><span class="p">,</span> <span class="sc">'\0'</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">m_ReceiveBuffer</span><span class="p">));</span>

		<span class="n">m_Socket</span><span class="p">.</span><span class="n">async_read_some</span><span class="p">(</span><span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">buffer</span><span class="p">(</span><span class="n">m_ReceiveBuffer</span><span class="p">),</span> <span class="n">boost</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">TCP_Client</span><span class="o">::</span><span class="n">handle_receive</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">error</span><span class="p">,</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">bytes_transferred</span><span class="p">));</span>

	<span class="p">}</span>


	<span class="kt">void</span> <span class="n">handle_connect</span><span class="p">(</span><span class="k">const</span> <span class="n">boost</span><span class="o">::</span><span class="n">system</span><span class="o">::</span><span class="n">error_code</span><span class="o">&amp;</span> <span class="n">error</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span>
			<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"connect failed : "</span> <span class="o">&lt;&lt;</span> <span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
		<span class="k">else</span>
		<span class="p">{</span>
			<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"connected"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

			<span class="n">PostWrite</span><span class="p">();</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="kt">void</span> <span class="n">handle_write</span><span class="p">(</span><span class="k">const</span> <span class="n">boost</span><span class="o">::</span><span class="n">system</span><span class="o">::</span><span class="n">error_code</span><span class="o">&amp;</span> <span class="cm">/*error*/</span><span class="p">,</span> <span class="kt">size_t</span> <span class="cm">/*bytes_transferred*/</span><span class="p">)</span>
	<span class="p">{}</span>

	<span class="kt">void</span> <span class="n">handle_receive</span><span class="p">(</span><span class="k">const</span> <span class="n">boost</span><span class="o">::</span><span class="n">system</span><span class="o">::</span><span class="n">error_code</span><span class="o">&amp;</span> <span class="n">error</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">bytes_transferred</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">error</span> <span class="o">==</span> <span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">error</span><span class="o">::</span><span class="n">eof</span><span class="p">)</span>
				<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"ì„œë²„ì™€ ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
			<span class="k">else</span>
				<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"error No: "</span> <span class="o">&lt;&lt;</span> <span class="n">error</span><span class="p">.</span><span class="n">value</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">" error Message: "</span> <span class="o">&lt;&lt;</span> <span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">else</span>
		<span class="p">{</span>
			<span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">strRecvMessage</span> <span class="o">=</span> <span class="n">m_ReceiveBuffer</span><span class="p">.</span><span class="n">data</span><span class="p">();</span>
			<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"ì„œë²„ì—ì„œ ë°›ì€ ë©”ì‹œì§€: "</span> <span class="o">&lt;&lt;</span> <span class="n">strRecvMessage</span> <span class="o">&lt;&lt;</span> <span class="s">", ë°›ì€ í¬ê¸°: "</span> <span class="o">&lt;&lt;</span> <span class="n">bytes_transferred</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

			<span class="n">PostWrite</span><span class="p">();</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>



<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">io_service</span> <span class="n">io_service</span><span class="p">;</span>

	<span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">tcp</span><span class="o">::</span><span class="n">endpoint</span> <span class="n">endpoint</span><span class="p">(</span><span class="n">boost</span><span class="o">::</span><span class="n">asio</span><span class="o">::</span><span class="n">ip</span><span class="o">::</span><span class="n">address</span><span class="o">::</span><span class="n">from_string</span><span class="p">(</span><span class="n">SERVER_IP</span><span class="p">),</span> <span class="n">PORT_NUMBER</span><span class="p">);</span>

	<span class="n">TCP_Client</span> <span class="n">client</span><span class="p">(</span><span class="n">io_service</span><span class="p">);</span>

	<span class="n">client</span><span class="p">.</span><span class="n">Connect</span><span class="p">(</span><span class="n">endpoint</span><span class="p">);</span>

	<span class="n">io_service</span><span class="p">.</span><span class="n">run</span><span class="p">();</span>


	<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"ë„¤íŠ¸ì› ì ‘ì† ì¢…ë£Œ"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

	<span class="n">getchar</span><span class="p">();</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<p><br /></p>

<h2 id="-ì „ë°˜ì ì¸-íë¦„--ì„œë²„-í´ë¼ì´ì–¸íŠ¸">ğŸ”” ì „ë°˜ì ì¸ íë¦„ : ì„œë²„-í´ë¼ì´ì–¸íŠ¸</h2>

<p><img src="https://user-images.githubusercontent.com/42318591/92299518-e33bdd80-ef8d-11ea-9f77-5c9215921a2b.png" alt="image" width="70%" height="70%" class="align-center" /></p>

<hr />
<p><br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„
</code></pre></div></div>

<p><a href="#" class="btn btn--primary align-right">ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°</a></p>
:ET